typeof IEnumerable=="undefined"&&(IEnumerable=function(){},IEnumerable.registerInterface("IEnumerable"));typeof IEnumerator=="undefined"&&(IEnumerator=function(){},IEnumerator.registerInterface("IEnumerator"));typeof Sys=="undefined"&&Type.registerNamespace("Sys");typeof Sys.IEnumerable$1=="undefined"&&(Sys.IEnumerable$1=function(){},Sys.IEnumerable$1.registerInterface("Sys.IEnumerable$1"));typeof Sys.IEnumerator$1=="undefined"&&(Sys.IEnumerator$1=function(){},Sys.IEnumerator$1.registerInterface("Sys.IEnumerator$1"));Type.registerNamespace("_Ewa");_Ewa.sx=function(){};_Ewa.mK=function(){};_Ewa.sx.registerClass("_Ewa.sx");_Ewa.mK.registerClass("_Ewa.mK");Type.registerNamespace("_Ewa");_Ewa.Bu=function(){};_Ewa.Wz=function(){};Type.registerNamespace("Common.App.CoauthTelemetry");Common.App.CoauthTelemetry.e=function(n){this.g=Function.createDelegate(this,this.k);this.h=Function.createDelegate(this,this.m);this.c={};this.d={};this.f=n};Common.App.CoauthTelemetry.e.prototype={e:null,f:null,b:null,a:function(n){var t=new($$sc.D.$$(Number)),i=this;return this.l().CW(function(){n in i.c?t.d(i.c[n]):i.d[n]=t}),t.a},l:function(){if(this.b)return this.b.a;this.b=new($$sc.D.$$(Object));var n=this;return this.f.CW(function(){n.e=n.f.a();n.e.b(n.h);n.i();n.b.b(null)}),this.b.a},i:function(){var t=this.e.a(),n;for(t.sort(this.g),this.c={},n=0;n<t.length;n++){if(!t[n]||!t[n].h())return;this.j(this.c,t[n].a(),n)}},j:function(n,t,i){n[t]=i;t in this.d&&(this.d[t].d(i),delete this.d[t])},m:function(){this.i()},k:function(n,t){var i=n,r=t;return i.p>r.p?1:i.p<r.p?-1:0}};Common.App.CoauthTelemetry.d=function(n,t,i,r,u,f,e,o,s){this.t=Function.createDelegate(this,this.x);this.n=Function.createDelegate(this,this.y);this.u=n;this.b=new($$sc.D.$$(Common.es));this.g=i;this.e=t;this.o=r;this.r=u;this.f=f;this.l=e;this.p=o;this.j=!1;this.k=!1;this.d=0;this.i=1;this.h=s;this.m=this.g.a("PeoplesWellExtraButtonInfoIsEnabled")};Common.App.CoauthTelemetry.d.prototype={u:null,b:null,e:null,g:null,o:null,r:null,f:null,l:null,p:null,m:!1,c:null,q:null,s:null,i:0,k:!1,j:!1,d:0,h:null,a:function(){var n=this;$$sc.a.WAA.call(null,this.l,this.e,this.f).CW(function(){n.c=n.l.a();n.q=n.e.a();n.s=n.f.a();$$sc.a.WAA.call(null,n.e.a().a(),n.f.a().a()).CW(function(){n.i=n.q.a().a();n.d=n.s.a().a();n.c.b(n.n);n.c.a().length&&n.v()})})},y:function(){this.v()},v:function(){var n=this.p(this.c.a());n?(this.c.c(this.n),this.w(this.j)):this.b.d(1);this.j=!0},w:function(n){var t,i;if(this.k){t=this;this.b.a.CW(function(){Diag.a.a(42062996,325,15,"We already attempted to log a render of coauthor gallery: {0}",Common.es.toString(t.b.a.a()))});return}this.k=!0;i=!this.i&&!n;this.z(i)},z:function(n){n?this.o.a(4,this.t,3):this.b.d(1)},x:function(){var i=this.r.b("AppInitStatus_"+Common.App.b.toString(4)),t,n;Diag.a.b(42259235,325,!!this.d,null);t=this.d-i;n={};n.InteractiveTime=i;n.ReactRenderComplete=this.d;n.HadTabSwitch=this.h();n.IsModernGallery=this.m;Diag.a.a(594883104,325,50,Common.O.b(n));this.m?(Diag.a.a(42062997,325,15,t.toString()),this.b.d(this.A(t)?3:2)):Diag.a.a(594883103,325,15,t.toString())},A:function(n){var i=this.g.c("CoauthorGalleryTimeToRenderDurationMs",1e4),t=n>i;return this.h()?(Diag.a.a(50455714,325,50,t.toString()),!1):(t&&(Diag.a.a(42062998,325,15,n.toString()),Common.r.a().recordQosError("CoauthorGalleryTimeToRenderDurationIsTooLong",["CoauthGalleryExperienceDegraded"],!1,!0,!0,!1,null)),t)}};Common.App.CoauthTelemetry.a=function(n,t){this.c=Function.createDelegate(this,this.f);this.b=n;this.d=t};Common.App.CoauthTelemetry.a.a=function(n){for(var t,i,r=null,f=n,e=f.length,u=0;u<e;++u)if(t=f[u],t)if(i=t.f()||!t.c()?t.a():t.c().toUpperCase(),r){if(r!==i)return!0}else r=i;return!1};Common.App.CoauthTelemetry.a.prototype={a:null,d:null,b:null,e:function(){var n=this;this.b.CW(function(){n.a=n.b.a();n.a.b(n.c)})},f:function(){Common.App.CoauthTelemetry.a.a(this.a.a())&&(this.a.c(this.c),this.d.IsRealCoauthSession=!0)}};Common.App.CoauthTelemetry.g=function(){};Common.App.CoauthTelemetry.g.a=function(){Common.App.a.a().a(new Common.App.CoauthTelemetry.g,0,!1)};Common.App.CoauthTelemetry.g.prototype={a:function(){return"Common.App.CoauthTelemetry"},c:function(n){var u=this,t,i,r;n.b(Common.App.CoauthTelemetry.a,null).c(Common.App.CoauthTelemetry.h,null).a().b(function(){return new Common.App.CoauthTelemetry.a(Common.Utils.b.a(Common.ck,n.c(Common.ck,null)),Common.a.e)});t=this;n.b(Common.App.CoauthTelemetry.d,null).c(Common.fr,null).a().b(function(){return new Common.App.CoauthTelemetry.d(Common.a.c(),Common.Utils.b.a(Common.dd,n.c(Common.dd,null)),Common.a.a,Common.App.AppLifecycleManager.get_instance(),Common.bk.a(),Common.Utils.b.a(Common.dX,n.c(Common.dX,null)),Common.Utils.b.a(Common.ck,n.c(Common.ck,null)),Common.App.CoauthTelemetry.a.a,function(){return t.d()})});i=this;n.b(Common.App.CoauthTelemetry.f,null).c(Common.App.CoauthTelemetry.b,null).a().b(function(){return new Common.App.CoauthTelemetry.f(Common.Utils.b.a(Common.dd,n.c(Common.dd,null)),Common.App.AppLifecycleManager.get_instance(),n.a(Common.App.CoauthTelemetry.c,null),Common.bk.a(),function(){return i.d()},Common.a.a,null,Common.r.a())});r=this;n.b(Common.App.CoauthTelemetry.e,null).c(Common.App.CoauthTelemetry.c,null).a().b(function(){return new Common.App.CoauthTelemetry.e(Common.Utils.b.a(Common.ck,n.c(Common.ck,null)))})},b:function(){var n=this;Common.a.a.i(function(){Common.Utils.a.a().a(Common.App.CoauthTelemetry.a,null).e();Common.a.a.a("CoauthorGalleryTelemetryIsEnabled")&&Common.Utils.a.a().a(Common.fr,null).a();Common.a.a.a("CashTelemetryIsEnabled")&&(Common.Utils.a.a().a(Common.App.CoauthTelemetry.b,null),Common.Utils.a.a().a(Common.App.CoauthTelemetry.c,null))})},d:function(){if(Common.Y.b()&&Common.bk.a().c("UserActions")){var n=Common.bk.a().b("UserActions");return n.VisiToggled>0}return!1}};Common.App.CoauthTelemetry.f=function(n,t,i,r,u,f,e,o){var s,h;this.l={};s=this;this.o=new($$sc.z.$$(Number))(function(){return f.e("PresenceBootLatencyThreshold",1e4)});h=this;this.i=new($$sc.z.$$(Number))(function(){return f.e("PresenceBootLatencyCutoffThreshold",6e4)});this.h=t;this.k=i;this.f=n;this.j=r;this.d=e;this.e=u;this.g=o;this.q()};Common.App.CoauthTelemetry.f.prototype={f:null,d:null,c:null,h:null,k:null,b:null,j:null,m:0,n:0,o:null,i:null,e:null,g:null,a:function(n,t,i,r){i&&(Diag.a.b(42274970,302,!this.d||this.d===i,"_myClientId is already set and you are trying to update it to something different"),this.d=i);var u=new($$sc.D.$$(Boolean)),f=this;return this.q().CW(function(){f.r(u,n,t,r)}),u.a},s:function(){return this.d||"{"+Common.a.l+"}"},q:function(){if(this.c)return this.c.a;this.c=new($$sc.D.$$(Object));this.e()&&Diag.a.a(50951700,302,15,"TabSwitched Session");var n=this;return this.f.CW(function(){var t=n.f.a(),i=t.a(),r=t.b();r.CW(function(){i.CW(function(){n.g&&n.g.addQosPillar(Common.QosPillarName.toString(6));n.v(i.a(),r.a());n.c.b(null)})})}),this.c.a},t:function(){if(this.b)return this.b.a;this.b=new($$sc.D.$$(Number));var n=this;return this.h.a(4,function(){var t=n.j.b("AppInitStatus_"+Common.App.b.toString(4));n.b.d(t)},3),this.b.a},v:function(n,t){this.m=n;this.n=t?t:(new Date).getTime()},r:function(n,t,i,r){var f=i?i.getTime():(new Date).getTime(),u;if(!(t in this.l)){u=new Common.App.CoauthTelemetry.i(t,this.u(),f,this.p(this.s()),this.p(t),this.o,this.i,r,this.e);this.l[t]=u;u.m(n);return}n.f()},u:function(){var n=new($$sc.D.$$(Number));return this.m===1?$$sc.a.a(Number,this.n):this.t()},p:function(n){return this.k.a(n)}};Common.App.CoauthTelemetry.i=function(n,t,i,r,u,f,e,o,s){this.j=n;this.f=t;this.a=i;this.b=r;this.d=u;this.g=f;this.e=e;this.i=o;this.h=s};Common.App.CoauthTelemetry.i.prototype={c:0,f:null,g:null,e:null,k:!1,a:0,b:null,d:null,i:0,j:null,h:null,m:function(n){var t=this;$$sc.a.WAA(this.f,this.b,this.d).CW(function(){var r,i,u,f,e;if(t.b.a()<=t.d.a()){n.d(!1);return}t.c=t.f.a();r=t.a-t.c;i=new Common.App.CoauthTelemetry.PL;i.id=t.j;i.et=t.a;i.st=t.c;i.d=t.a-t.c;i.mp=t.b.a();i.tp=t.d.a();i.ct=t.l(t.i);i.vc=t.h();u=JSON.stringify(i);Diag.a.a(42078597,302,15,u);r>t.g.a()&&!t.k&&!i.vc&&r<t.e.a()&&(t.k=!0,n.d(!0),e=(f=new Common.bs,f.extendedProperties=new Map,f),e.extendedProperties.set("data",u),Common.r.a().recordQosError("PresenceRenderDurationIsTooLong",["PresenceExperienceDegraded"],!1,!0,!1,!1,e),Diag.a.a(42078598,302,15,"{d:"+r+",vt:"+t.g.a()+",ct:"+t.e.a()+"}"));n.a.b>3||n.d(!1)})},l:function(n){switch(n){case 2:return"NonWac";case 0:return"Unknown";case 1:return"Wac";default:return"Unknown"}}};Common.App.CoauthTelemetry.PL=function(){};Common.App.CoauthTelemetry.PL.prototype={id:null,et:0,st:0,mp:0,tp:0,d:0,ct:null,vc:!1};Common.App.CoauthTelemetry.e.registerClass("Common.App.CoauthTelemetry.e",null,Common.App.CoauthTelemetry.c);Common.App.CoauthTelemetry.d.registerClass("Common.App.CoauthTelemetry.d",null,Common.fr);Common.App.CoauthTelemetry.a.registerClass("Common.App.CoauthTelemetry.a",null,Common.App.CoauthTelemetry.h);Common.App.CoauthTelemetry.f.registerClass("Common.App.CoauthTelemetry.f",null,Common.App.CoauthTelemetry.b);Common.App.CoauthTelemetry.i.registerClass("Common.App.CoauthTelemetry.i");Common.App.CoauthTelemetry.PL.registerClass("Common.App.CoauthTelemetry.PL");Common.App.CoauthTelemetry.g.a();Type.registerNamespace("Common.App.CollabControls");Common.App.CollabControls.l=function(){};Common.App.CollabControls.l.registerInterface("Common.App.CollabControls.l");Common.App.CollabControls.m=function(){};Common.App.CollabControls.c=function(){};Common.App.CollabControls.c.prototype={multipleBrowsersImageClassName:0,peopleImageClassName:1,peopleImageClusterPath:4,multipleBrowserImageClusterPath:5,imageDimension:6,rtl:8,pointerInputManager:9,clickInputManager:10,vertical:11,zIndex:12,contextMenuInputManager:13,imageDomElement:14,useIdleTooltip:15,viewportBoundsCallback:16,flipHorizontalDirection:17,fixRemoveFadeOutElementCrash:18};Common.App.CollabControls.c.registerEnum("Common.App.CollabControls.c",!1);Common.App.CollabControls.i=function(n){this.K=Function.createDelegate(this,this.bn);Common.App.CollabControls.i.initializeBase(this);this.l=n};Common.App.CollabControls.i.a=function(n,t){return n+(t?"Rtl":"")};Common.App.CollabControls.i.prototype={l:null,bl:function(){return this.l.style.visibility==="visible"},I:function(n){return this.l.style.visibility=n?"visible":"hidden",n},bm:function(n){return this.l.dir=n?"rtl":"ltr",n},dispose:function(){this.l&&this.l.parentNode&&this.l.parentNode.removeChild(this.l);this.l=null;Common.ba.prototype.dispose.call(this)},ba:function(n){return this.l.ownerDocument.createElement(n)},bn:function(){return!0}};Common.App.CollabControls.e=function(n,t){Common.App.CollabControls.e.initializeBase(this);this.a=n;this.b=t};Common.App.CollabControls.e.prototype={a:0,b:null};Common.App.CollabControls.f=function(n,t,i){this.O=Function.createDelegate(this,this.S);this.z=Function.createDelegate(this,this.br);this.o=[];Common.App.CollabControls.f.initializeBase(this,[n]);this.D={};this.Q=i;this.E=i.b(8,!1);this.P=i.b(15,!1);this.A=i.b(12,0);this.t=i.b(6,0);this.bb=t;this.R=i.b(16,null);this.V=i.b(17,!1);this.J=0;this.W=new Common.App.CollabControls.j(this.E,this.V);this.B=this.be();this.M=!1;this.q=[];this.C=[];this.l.id=Common.App.CollabControls.f.b();this.l.className=Common.App.CollabControls.i.a("prControl",this.E);this.A&&(this.l.style.zIndex=this.A);this.bm(this.E);this.bt(t);this.r=this.ba("div");this.r.className="prFlyoutContainer";this.l.appendChild(this.r);this.p=[];this.u=new Common.App.CollabControls.k(this.p,this.l,this.t,4,6,32,this.E);this.x=i.b(9,null);this.x.a("msospPointerDown",this.u.a,this.z);this.x.a("msospPointerOver",this.u.a,this.z);this.x.a("msospPointerOut",this.u.a,this.z)};Common.App.CollabControls.f.b=function(){return String.format("{0}-{1}","presencetooltip",Common.App.CollabControls.f.a++)};Common.App.CollabControls.f.prototype={E:!1,w:!1,L:!1,s:!1,bb:0,J:0,F:!1,P:!1,V:!1,M:!1,D:null,r:null,u:null,q:null,C:null,W:null,B:0,x:null,Q:null,R:null,c:function(){return Common.M.c(this.o)},p:null,A:0,t:0,v:function(){return this.p?this.p.length:0},y:function(){return this.v()>0?this.p[0].b:5},bd:function(){return this.y()===3&&!this.w},a:function(){return this.l},dispose:function(){var t;if(this.bd()){this.M=!0;return}if(this.p)for(var i=this.p,r=i.length,n=0;n<r;++n)t=i[n],t.A(this.O),System.a.a(t);this.p=null;this.x.b("msospPointerDown",this.u.a,this.z);this.x.b("msospPointerOver",this.u.a,this.z);this.x.b("msospPointerOut",this.u.a,this.z);Common.App.CollabControls.i.prototype.dispose.call(this)},i:function(){this.G(!1);this.I(!0)},h:function(){this.I(!0);this.bc();this.w=!0},e:function(){this.bi(5);this.bf();this.u.i(this.y(),this.F)},b:function(n){var u=this.y(),f=this.w,i,r,t;if(n.n||(n.n=(Common.App.CollabControls.f.a++).toString()),i=0,n.n in this.D&&(i=this.N(n.n),i>=0)){if(r=this.o[i],r.r===n.r&&r.o===n.o)return;this.f(n.n)}this.e();t=new Common.App.CollabControls.a(this.ba("div"),this.Q);t.D(this.O);this.r.insertBefore(t.l,this.r.firstChild);this.D[n.n]=t;Array.add(this.o,n);Array.add(this.p,t);this.bk(u,f);this.I(!0)},f:function(n){if(this.bd()){Array.add(this.C,n);return}var t=this.y(),i=this.w;this.e();this.bj(n);this.bk(t,i)},bk:function(n,t){this.o.length<=0?this.e():n===3&&t?this.h():this.i()},g:function(n,t){t?this.bo(n):this.bh(n)},d:function(n){n!==this.L&&(this.L=n,this.Y(n))},j:function(n,t){this.l.style.top=t+"px";this.l.style.left=n+"px"},G:function(n){var i,t;if(!n||this.s){this.L&&this.Y(!0);var r=Math.min(3,this.v())-1,u=0,f=1,e=0;for(this.F&&(u=this.B,f=-1,e=-this.t),i=this.v()-1;i>r;i--)this.p[i].C(this.o[i],r*-4*f+e,0,!0,!1,!0,u);for(t=r;t>=0;t--)this.p[t].C(this.o[t],t*-4*f+e,0,t>0,Array.contains(this.q,this.o[t].n),t!==this.J,u);this.J=0;this.u.i(0,this.F);this.l.style.zIndex=this.A;this.w=!1;this.bi(0);this.M&&this.dispose()}},bc:function(){var t,i,r,u,f,e,n;for(this.L&&this.Y(!1),this.l.style.zIndex=this.A+1,this.bu(u={val:i},f={val:t},e={val:r}),i=u.val,t=f.val,r=e.val,n=0;n<this.v();n++)this.p[n].V(this.o[n],i,t+(this.t+2)*n,n!==this.J,r)},bf:function(){var t=0,i=0,n;for(this.F&&(t=this.B,i=-6),n=0;n<this.v();n++)this.p[n].M(this.o[n],i,t);this.l.style.zIndex=this.A;this.w=!1;this.I(!1);this.M&&this.dispose()},X:function(n){if(n){this.s=!0;var t=this;$$sc.a.b(n).CW(function(){t.P?t.bq():t.G(!0);t.s=!1})}else this.P?this.e():this.G(!1)},bq:function(){this.s&&this.e()},S:function(n,t){var i=this.y(),r;t.a===2||t.a===4&&i!==3?(this.s&&(this.s=!1),i!==3&&(this.bc(),t.b.b===3&&this.X(2e3))):t.a===4&&i===3?(this.s&&(this.s=!1),this.X(0)):t.a===3&&i===3&&(this.w||(this.v()>1?(this.s=!0,r=this,$$sc.a.b(250).CW(function(){r.G(!0);r.s=!1})):this.X(0)));this.k("InteractivityChanged",t,null)},br:function(n){return n.b===3?this.S(this,new Common.App.CollabControls.e(4,n)):n.d==="msospPointerOver"?this.S(this,new Common.App.CollabControls.e(2,n)):n.d==="msospPointerOut"&&this.S(this,new Common.App.CollabControls.e(3,n)),!1},bt:function(n){this.l.style.width=n+"px";this.l.style.height=this.t+"px"},bj:function(n){var t,r,i;(this.bh(n),t=this.N(n),t<0)||(r=this.o[t],Array.removeAt(this.o,t),delete this.D[r.n],i=this.p[t],this.r.removeChild(i.l),this.Q.b(18,!1)&&i.A(this.O),Array.removeAt(this.p,t),i.dispose())},bi:function(n){if(this.C.length){this.bl()&&this.bf();for(var t=0;t<this.C.length;t++)this.bj(this.C[t]);Array.clear(this.C);this.o.length<=0||n===5?this.e():n||this.i()}},N:function(n){for(var t=0;t<this.o.length;t++)if(this.o[t].n===n)return t;return-1},bg:function(n){var t,r,i;n in this.D&&(t=this.N(n),t&&(r=this.o[t],i=this.D[n],Array.removeAt(this.o,t),Array.insert(this.o,0,r),Array.removeAt(this.p,t),Array.insert(this.p,0,i),this.r.removeChild(i.l),this.r.appendChild(i.l),this.G(!1)))},bo:function(n){if(this.N(n)===-1){Diag.a.a(41706451,302,15,"Cannot set active editor because client id is invalid");return}if(Array.contains(this.q,n)){if(this.o[0].n===n)return;Array.remove(this.q,n)}Array.add(this.q,n);this.bg(n);this.y()!==1&&this.G(!1)},bh:function(n){if(this.N(n)===-1){Diag.a.a(41706452,302,50,"Cannot remove active editor because client id is invalid");return}if(Array.contains(this.q,n)){if(Array.remove(this.q,n),this.o[0].n===n&&this.q.length>0){var t=this.q[this.q.length-1];this.bg(t)}this.o[0].n===n&&this.y()===1&&this.G(!1)}},Y:function(n){n?Sys.UI.DomElement.addCssClass(this.r,"prBackgroundSelection"):Sys.UI.DomElement.removeCssClass(this.r,"prBackgroundSelection")},bu:function(n,t,i){var u,f,r;if(n.val=0,t.val=0,i.val=this.B,this.R){if(u=this.R(this),!u)return;f=this.y()===4;r=this.W.g(this.v(),f?6:this.t,this.t,150,2,this.l,u);t.val=r.a;this.J=this.bp(r.c,r.a);i.val=r.b;i.val!==this.B&&(this.bs(i.val),this.l.dir=i.val===3?"rtl":"ltr",this.B=i.val);i.val!==this.be()?(n.val=f?-6:-this.t,this.F=!0):this.F=!1}},bp:function(n,t){if(n===1)return this.v()-1;var i=Math.abs(t);return i>0?i/(this.t+2):0},bs:function(n){for(var t=0;t<this.v();t++)this.p[t].S(n)},be:function(){return this.E?3:4}};Common.App.CollabControls.b=function(){};Common.App.CollabControls.b.h=function(n,t,i,r){return Common.App.CollabControls.b.i(n,t,i,r)};Common.App.CollabControls.b.i=function(n,t,i,r){var u=document.createElementNS(Common.App.CollabControls.b.a,"svg");return u.setAttribute("viewBox",String.format(Common.App.CollabControls.b.f,Common.App.CollabControls.b.c,Common.App.CollabControls.b.b)),u.appendChild(Common.App.CollabControls.b.j(n,t,i,r)),u};Common.App.CollabControls.b.j=function(n,t,i,r){var e=Common.App.CollabControls.b.c/n,h=t/2*e,c=Common.App.CollabControls.b.b/2,o=0,f,u,s;for(r&&(o=(n-t*3-i*4)*e/2),f=document.createElementNS(Common.App.CollabControls.b.a,"g"),f.setAttribute("class",Common.App.CollabControls.b.e),u=1;u<=3;u++)s=o+(u*(t+i)-t/2)*e,f.appendChild(Common.App.CollabControls.b.g(u,h,s,c));return f};Common.App.CollabControls.b.g=function(n,t,i,r){var u=document.createElementNS(Common.App.CollabControls.b.a,"circle");return u.setAttribute("class",String.format("{0}-{1}",Common.App.CollabControls.b.d,n)),u.setAttribute("cx",String.format("{0}",i)),u.setAttribute("cy",String.format("{0}",r)),u.setAttribute("r",String.format("{0}",t)),u};Common.App.CollabControls.g=function(n){this.b=n;this.b.d(10,Common.i.a());this.b.d(9,Common.f.a());this.b.d(6,20);this.b.d(13,Common.bg.a());this.b.d(17,!1)};Common.App.CollabControls.g.prototype={b:null,a:function(n,t){return this.b.d(15,t),new Common.App.CollabControls.f(n,20,this.b)}};Common.App.CollabControls.a=function(n,t){this.u=Function.createDelegate(this,this.Q);this.t=Function.createDelegate(this,this.P);this.s=Function.createDelegate(this,this.O);this.r=Function.createDelegate(this,this.N);Common.App.CollabControls.a.initializeBase(this,[n]);this.q=t.b(8,!1);this.f=t.b(6,0);this.w=t.b(15,!1);this.z=t;this.o=0;this.l=n;this.l.className=Common.App.CollabControls.a.h;this.a=document.createElement("span");this.l.appendChild(this.a);this.v=Common.App.CollabControls.b.h(t.b(6,0),4,2,!0);this.R(t);this.b=5};Common.App.CollabControls.a.prototype={g:null,e:null,j:null,z:null,a:null,p:null,v:null,f:0,q:!1,w:!1,i:null,o:0,c:null,D:function(n){this.m("InteractivityChanged",n)},A:function(n){this.n("InteractivityChanged",n)},y:null,b:0,dispose:function(){this.l&&(this.g.b("click",this.l,this.r),this.g.b("dblclick",this.l,this.K),this.e.b("msospPointerDown",this.l,this.s),this.e.b("msospPointerOut",this.l,this.t),this.e.b("msospPointerOver",this.l,this.u),this.j.c(this.l,this.K));Common.App.CollabControls.i.prototype.dispose.call(this)},R:function(n){this.g=n.b(10,null);this.g.a("click",this.l,this.r);this.g.a("dblclick",this.l,this.K);this.e=n.b(9,null);this.e.a("msospPointerOver",this.l,this.u);this.e.a("msospPointerOut",this.l,this.t);this.e.a("msospPointerDown",this.l,this.s);this.j=n.b(13,null);this.j.a(this.l,this.K)},M:function(n,t,i){this.w&&n?this.W(n,t,i):(this.b===3&&this.B(),this.I(!1),this.b=5)},W:function(n,t,i){this.x(n,t,15,4,!1,i)},C:function(n,t,i,r,u,f,e){var o=r?2:u?1:0;this.x(n,t,i+20,o,f,e)},V:function(n,t,i,r,u){this.x(n,t,i+20,3,r,u)},x:function(n,t,i,r,u,f){n&&(r!==this.b||!this.L(t,i))&&(this.E(r,u,f),this.G(n,r,f),this.b=r,f!==4&&(f||this.q)?this.l.style.right=t+"px":this.l.style.left=t+"px",this.l.style.top=i+"px",this.I(!0))},G:function(n,t,i){var r,u;this.y=n;Common.m.h(this.a);Common.C.g(this.a);this.a.id="fly_"+n.n;this.a.style.backgroundColor=n.r;t!==4?(this.a.style.height=this.f+"px",this.a.style.lineHeight=this.f+"px",Common.C.e(this.a,"border-radius",this.f+"px")):i!==4&&(i||this.q)?this.a.style.right="0px":this.a.style.left="0px";t!==2&&(t===4?Common.m.m(this.a,""):t===1?this.a.appendChild(this.v):(this.a.setAttribute("dir","auto"),r=Common.d.bc(n.o,!1,!1),!n.w&&r||t?(u=n.o,t||(u=r,Common.C.e(this.a,"text-align","center")),Common.m.m(this.a,u)):(this.p||(this.p=this.J()),this.a.appendChild(this.p),Common.C.e(this.a,"text-align","start"))))},N:function(n){return this.b?(this.b===3&&Diag.a.a(50436114,302,50,"User clicked on presence pill."),!1):(this.k("InteractivityChanged",new Common.App.CollabControls.e(1,n),null),!0)},P:function(n){return this.b===3&&this.k("InteractivityChanged",new Common.App.CollabControls.e(3,n),null),!1},Q:function(n){return n.b!==3&&this.k("InteractivityChanged",new Common.App.CollabControls.e(2,n),null),!1},O:function(n){return n.b!==3?!0:(this.k("InteractivityChanged",new Common.App.CollabControls.e(4,n),null),!1)},J:function(){var n=document.createElement("img");return n.setAttribute("src",Common.A.c("doughperson_white_glyph.svg")),n.setAttribute("Unselectable","on"),n.setAttribute("role","presentation"),Common.H.c(this.f,this.f,null,null,Common.App.CollabControls.a.k,"",!1,"",this.l.ownerDocument,n)},E:function(n,t,i){if(!this.h(this.b)||!this.h(n)){Sys.UI.DomElement.removeCssClass(this.l,this.i);switch(this.b){case 4:n===3?this.d(Common.App.CollabControls.a.b,Common.App.CollabControls.a.f):this.h(n)&&this.d(Common.App.CollabControls.a.a,Common.App.CollabControls.a.f);break;case 3:n===4?this.d(Common.App.CollabControls.a.d,Common.App.CollabControls.a.e):this.h(n)&&(t&&this.B(),this.d(Common.App.CollabControls.a.a,Common.App.CollabControls.a.e,t?Common.App.CollabControls.a.j:""));break;case 0:case 1:case 2:if(n===4)this.d(Common.App.CollabControls.a.d,Common.App.CollabControls.a.c);else if(n===3){t&&this.F();var r=i===3?Common.App.CollabControls.a.m:Common.App.CollabControls.a.l;this.d(Common.App.CollabControls.a.b,Common.App.CollabControls.a.c,t?Common.App.CollabControls.a.g:"",r)}break;default:n===4?this.d(Common.App.CollabControls.a.d):n===3?this.d(Common.App.CollabControls.a.b):this.h(n)&&this.d(Common.App.CollabControls.a.a)}}},d:function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];this.i=t.join(" ");Sys.UI.DomElement.addCssClass(this.l,this.i)},F:function(){var n=this;this.o=window.setTimeout(function(){n.l&&(n.c=n.l.cloneNode(!0),n.l.parentNode.appendChild(n.c),n.l.style.zIndex=2,n.c.style.zIndex=1)},300)},B:function(){if(window.clearTimeout(this.o),this.c){Sys.UI.DomElement.removeCssClass(this.c,Common.App.CollabControls.a.c+" "+Common.App.CollabControls.a.g);Sys.UI.DomElement.addCssClass(this.c,Common.App.CollabControls.a.i);var n=this;$$sc.a.b(300).CW(function(){n.l&&n.l.parentNode===n.c.parentNode&&n.l.parentNode.removeChild(n.c)});Common.C.d(this.l,"z-index")}},h:function(n){return!n||n===1||n===2},L:function(n,t){var i=Common.C.b(this.l.style.left),r=Common.C.b(this.l.style.top);return i===n&&r===t},S:function(n){var t,i;n===3&&Common.C.c(this.l,"left")?(t=Common.C.b(this.l.style.left),Common.C.d(this.l,"left"),this.l.style.right=-1*t+"px"):n===4&&Common.C.c(this.l,"right")&&(i=Common.C.b(this.l.style.right),Common.C.d(this.l,"right"),this.l.style.left=-1*i+"px")}};Common.App.CollabControls.j=function(n,t){this.a=n;this.b=t};Common.App.CollabControls.j.prototype={a:!1,b:!1,g:function(n,t,i,r,u,f,e){var l=e.y,a=e.height,d=this.f(f),h=d,g=h+t,v=n*i+(n-1)*u,s=null,o=null,y;if(n===1||h+v<=l+a?s=new Common.App.CollabControls.d(0,0,2,4):(s=this.d(g,v,l,a),y=s.a-h,s.a=y),this.b)o=new Common.App.CollabControls.d(0,0,2,this.a?4:3);else{var p=this.e(f,e),c=Math.max(0,e.x),w=e.width,b=p,k=p+t;b+r<=c+w?o=new Common.App.CollabControls.d(0,0,2,this.a?3:4):r<=k-c&&(o=new Common.App.CollabControls.d(0,0,2,this.a?4:3));o||(o=this.c(b,k,r,c,w))}return new Common.App.CollabControls.d(s.a,o.d,s.c,o.b)},f:function(n){return Common.g.I(n)},e:function(n,t){return this.a?t.width-Common.g.H(n):Common.g.G(n)},d:function(n,t,i,r){var u=1,f=Math.max(i,n-t),o=n-i,e;return t>o&&(u=2,e=t<r,f=e?r-t:i),new Common.App.CollabControls.d(f,0,u,4)},c:function(n,t,i,r,u){var f,e,o=n-r,s=u-t;return s>=o?(e=t,f=4):(e=n,f=3),new Common.App.CollabControls.d(0,e,2,f)}};Common.App.CollabControls.d=function(n,t,i,r){this.a=n;this.d=t;this.c=i;this.b=r};Common.App.CollabControls.d.prototype={a:0,d:0,c:0,b:0};Common.App.CollabControls.k=function(n,t,i,r,u,f,e){this.b=n;this.f=t;this.e=i;this.g=r;this.h=u;this.c=f;this.d=e;this.a=document.createElement("div");this.a.className="prTouchTarget"};Common.App.CollabControls.k.prototype={b:null,f:null,d:!1,e:0,g:0,h:0,c:0,a:null,i:function(n,t){if(n!==3){if(n===5||!this.b||!this.b.length){this.a.parentNode&&this.a.parentNode.removeChild(this.a);return}var f=0,u=0,i=0,r=0;n===4?(i=this.h,r=(this.c-i)/2,this.a.style.height=this.c+"px",this.a.style.width=this.c+"px",f=Common.C.b(this.b[0].l.style.top),u=Common.C.b(this.d?this.b[0].l.style.right:this.b[0].l.style.left)):(i=this.e,r=(this.c-i)/2,this.a.style.height=this.c+"px",this.a.style.width=this.k()+r*2+"px",f=Common.C.b(this.b[this.b.length-1].l.style.top),u=this.j(this.b[this.b.length-1].l,i,t));Common.C.e(this.a,"border-radius",this.c+"px");this.a.style.top=f-r-i+"px";this.d?this.a.style.right=u-r+"px":this.a.style.left=u-r+"px";this.a.parentNode||this.f.insertBefore(this.a,this.f.firstChild)}},j:function(n,t,i){return this.d&&!i?Common.C.b(n.style.right):this.d||i?this.d&&i?-Common.C.b(n.style.left)-t:-Common.C.b(n.style.right)-t:Common.C.b(n.style.left)},k:function(){return!this.b||!this.b.length?0:this.e+Math.min(this.b.length-1,2)*this.g}};Common.App.CollabControls.h=function(){this.c={}};Common.App.CollabControls.h.prototype={b:function(n,t){var r=Common.App.CollabControls.c.toString(n),i;return typeof t=="number"?(i=this.c[r],i?Number.parseInvariant(i.toString()):0):this.c[r]},a:function(n,t){this.c[Common.App.CollabControls.c.toString(n)]=t},d:function(n,t){Common.App.CollabControls.c.toString(n)in this.c||(this.c[Common.App.CollabControls.c.toString(n)]=t)}};Common.App.CollabControls.i.registerClass("Common.App.CollabControls.i",Common.ba,Sys.IDisposable);Common.App.CollabControls.e.registerClass("Common.App.CollabControls.e",Sys.EventArgs);Common.App.CollabControls.f.registerClass("Common.App.CollabControls.f",Common.App.CollabControls.i,Common.App.CollabControls.l,Sys.IDisposable);Common.App.CollabControls.a.registerClass("Common.App.CollabControls.a",Common.App.CollabControls.i);Common.App.CollabControls.f.a=0;Common.App.CollabControls.b.a="http://www.w3.org/2000/svg";Common.App.CollabControls.b.e="prDancingDots";Common.App.CollabControls.b.d="prAnimateCircle";Common.App.CollabControls.b.f="0 0 {0} {1}";Common.App.CollabControls.b.b=40;Common.App.CollabControls.b.c=120;Common.App.CollabControls.a.h="prModernFlyout UIFont";Common.App.CollabControls.a.d="flyoutIdle";Common.App.CollabControls.a.b="flyoutExpanded";Common.App.CollabControls.a.a="flyoutCollapsed";Common.App.CollabControls.a.f="flyoutFromIdle";Common.App.CollabControls.a.e="flyoutFromExpanded";Common.App.CollabControls.a.c="flyoutFromCollapsed";Common.App.CollabControls.a.g="flyoutStacked";Common.App.CollabControls.a.j="flyoutFromStacked";Common.App.CollabControls.a.i="flyoutFadeOut";Common.App.CollabControls.a.k="cui-img-cont-float cui-img-20by20";Common.App.CollabControls.a.l="flyoutLtrDir";Common.App.CollabControls.a.m="flyoutRtlDir";Type.registerNamespace("Common.App.Presence");Common.App.Presence.a=function(n,t,i,r,u,f,e,o,s){this.p=Function.createDelegate(this,this.y);this.o=Function.createDelegate(this,this.v);this.n=Function.createDelegate(this,this.u);this.q=new Common.ba;this.k=n;this.j=t;this.i=i;this.g=r;this.d=f;Common.App.Presence.a.a=u;this.l=e;this.f=o;this.m=s;$$sc.a.WAA(t,i).CW(this.n)};Common.App.Presence.a.prototype={a:null,e:!0,c:null,k:null,d:0,j:null,b:null,i:null,h:null,g:null,l:null,f:null,m:!1,s:function(){this.q.k("u",null,this)},u:function(){this.j.a()&&this.i.a()&&(this.b=this.j.a(),this.h=this.i.a(),this.b.e(this.o),this.c=new Common.X(2,2,this.d,this.p,88,null,!1,0),Common.App.Presence.a.a.a(this.c))},v:function(n,t){(this.e||this.w(t.b))&&Common.App.Presence.a.a.d(this.c,0)},w:function(n){var f=n,i,e,t,r,u;for(i in f)if(e={key:i,value:f[i]},t=this.g.a(e),t&&t.a()&&(r=t.a().toLowerCase(),u=this.a[r]||this.a[r.toUpperCase()],u&&u.a===2))return!0;return!1},y:function(n){var f=this.b.p(),i,r,c,l,a,e,v,k,t,y,u,p,s,h;if(f){if(i=new Date,r=!1,this.e){this.a=f;this.e=!1;c=this.a;for(l in c)a={key:l,value:c[l]},e=a.value,e.b<i&&(i=e.b),e.a===2&&(r=!0,this.h.a(a.key));r&&this.s();Common.App.Presence.a.a.d(n,this.r(i));return}var o=new($$sc.u.$$(String)),w=!1,b=this.a;for(v in b)(k={key:v,value:b[v]},t=k.key,t in this.a&&this.k.a()!==t)&&(y=this.a[t],u=f[t],y&&u&&(p=y.a,s=u.a,p===2&&s===1?(o.b(t),Diag.a.a(38052609,392,50,t+" returned from away")):p===1&&s===2&&(r=!0,w=!0,this.h.a(t),Diag.a.a(38052610,392,50,t+" went away")),s===1&&u.b<i&&(i=u.b)));this.a=f;Common.App.Presence.a.a.d(n,this.r(i));(o.e.length>0||r)&&this.s();o.e.length>0&&!this.m?(h=this.t(o),this.x(h)):h=new($$sc.u.$$(String));(w||h.e.length>0)&&this.l(2052777571,2,null)}},x:function(n){var i,r,t;if(n.e.length)for(i=n.$$lge();i.$$mn();)r=i.$$cu(),t=this.f.b(String.format($a.eo,r),!1),t.b(5),t.f("CoAuth_AuthorStatus_16x16x32"),this.f.a(t)},t:function(n){var e=this.b.o(),i=new($$sc.u.$$(String)),f=e,r,t,u;for(r in f)t={key:r,value:f[r]},n.c(t.key)&&(u=this.g.a(t),u&&(i.b(u.d()),n.d(t.key)));return i.e.length||Diag.a.a(38052611,392,10,"There were no coauthor names found"),i},r:function(n){var t=new Date;return Math.max(n.getTime()+this.d-t.getTime(),0)}};Common.App.Presence.b=function(){this.b=updates};Common.App.Presence.b.prototype={b:0,a:function(n){return!!(this.b&n)},toString:function(){if(this.a(0))return"none";var n=new($$sc.u.$$(String));return this.a(1)&&n.b("user(s) joined"),this.a(2)&&n.b("user(s) disconnected"),this.a(4)&&n.b("user(s) updated"),n.f().join(", ")}};Common.App.Presence.a.registerClass("Common.App.Presence.a");Common.App.Presence.a.a=null;Type.registerNamespace("RealtimePresenceUI");RealtimePresenceUI.f=function(){};RealtimePresenceUI.f.registerInterface("RealtimePresenceUI.f");RealtimePresenceUI.b=function(n,t,i,r){var u,f;this.z=Function.createDelegate(this,this.bf);this.k=Function.createDelegate(this,this.bg);this.p=new($$sc.D.$$(Number));this.c=n;this.i=t;i&&(u=this,i.CW(function(){u.g=i.a();u.g.b(u.k);u.j()}));r&&(f=this,r.CW(function(){f.f=r.a();f.f.a(f.k);f.j()}));this.A=new Common.dg(this.c.d,"Anonymous user","#cccccc",new Common.dl(7),null,null,null,null,!1,!1,!1,0,null,0);this.m=!0;this.h=!0;this.o=!1;this.l=!1;this.d=RealtimePresenceUI.e.a(this.c.d,this.c.b,n.e)};RealtimePresenceUI.b.a=function(n,t){var i=n,r=t;return i.b().a(1)&&r.b().a(1)||!i.b().a(1)&&!r.b().a(1)?Common.d.bj(n.o,t.o):i.b().a(1)?-1:1};RealtimePresenceUI.b.prototype={A:null,m:!1,o:!1,l:!1,c:null,d:null,i:null,g:null,f:null,h:!1,S:function(){return Common.a.a?Common.a.a.a("ColorPresenceHashIsEnabled"):!1},E:function(){return Common.a.a?Common.a.a.a("PeoplesWellExtraButtonInfoIsEnabled"):!1},U:function(n,t,i,r,u,f){var e,o,s,h,c=this.V();this.d.a()?this.d.a()===1?(e=!0,o=this.c.a.a.a,s=this.c.a.a.b,h=this.d.b()[0].e()):(e=!0,o=this.c.a.h.a,s=this.c.a.h.b,h=""):(e=!1,o="",s="",h="");n.val=c[0];t.val=c.slice(1);i.val=e;r.val=o;u.val=s;f.val=h},V:function(){if(this.d.a()>=2)return[String.format($a.hf,this.d.a())];if(this.d.a()===1){var n=this.d.b()[0],t=this.c.b(n.a());return t&&t.a===2?[$a.hi,n.d()]:[n.g()?$a.hh:$a.hg,n.d()]}return[$a.hj]},bd:function(n){return this.be(n)},C:function(n,t,i){if(!t)return i&&Diag.a.a(4482393,325,50,"User does not have any presence data"),!1;if(!this.B(n,t))return i&&Diag.a.a(4482394,325,50,"User has presence data but app can't use it"),!1;var r=this.c.b(n);return r&&r.a===2?!1:!0},Y:function(n){return n.g()?$a.hl:$a.k},be:function(n){if(!n.b().a(1))return this.Y(n);var t=n.g(),i=this.c.b(n.a()),r=this.c.c(n.a());if(!i)return $a.k;switch(i.a){case 1:return r?t?$a.hm:this.D(n.a(),t,r)||$a.k:$a.k;case 2:return $a.hk;default:return $a.k}},X:function(n){return this.i.i()?this.i.d(n.c(),"O365",Common.a.i,0):undefined},Z:function(n){var t=this.c.b(n.a());return!t||t&&t.a===1?!0:!1},bc:function(n){return this.f?this.f.b(n.a()):n.b().a(4)},ba:function(n){var c=String.format("buttonPeoplesWellUser-{0}",n.a()),u=n.a(),l=this.bd(n),f=n.d(),a=n.e(),t,i=(t=new Common.hv,t.Id=c,t.Command=this.c.a.e.toString(),t.LabelText="{0}",t.Image32by32=this.c.a.i.a,t.Image32by32Class=this.c.a.i.b,t.MenuItemId=u,t.CommandValueId=u,t.Alt=f,t.DisplayMode=this.G(),t.LabelCss="display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word",t.Description=l,t.ImageBackColor=a,t.IsAnonymous=n.f(),t.LabelTextUserGeneratedPlaceholderReplacements=CommandUI.b.w([f]),t.Upn=n.c(),t),r,e,o,s,h;return Common.a.a.a("PeoplesWellExtraButtonInfoIsEnabled")&&this.i&&(r=this.X(n),e=this.Z(n),i.ImageUrl=r,i.ActiveStatus=e,o=n.h(),i.JoinTimeInMS=o,s=this.C(n.a(),this.c.c(n.a()),!1),h=this.bc(n),i.CanJump=s,i.ChatCapable=h,r===""&&Diag.a.a(40969413,302,50,"ImageURL collection failed")),i},W:function(){var n;return n=new Common.bV,n.Id="BasicChat",n.Command="2288458806",n.LabelText=$a.it,n.LabelCss="display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word",n},G:function(){return this.S()?"Initials":"Menu32"},bb:function(n){for(var u,f,i=[],r=n,e=r.length,t=0;t<e;++t)u=r[t],f=this.ba(u),Array.add(i,f);return i},bi:function(n){if(!this.m)return!0;this.h||(n[CommandUI.Controls.d.Visible]=!0);var i,t,r,e,u,f,o,s,h,c,l,a;return this.U(o={val:i},s={val:t},h={val:r},c={val:e},l={val:u},a={val:f}),i=o.val,t=s.val,r=h.val,e=c.val,u=l.val,f=a.val,n[CommandUI.Controls.d.LabelText]=i,t&&t.length&&(n[CommandUI.Controls.d.LabelTextUserGeneratedPlaceholderReplacements]=t),n.ImageIsVisible=r,n[CommandUI.Controls.d.Image16by16Class]=u,n.ImageBackColor=f,this.m=!1,!0},bh:function(n){var e,r,o;if(this.d.a()<=0)return!1;var s=this.bm(this.d.b()),h=this.bb(s),i,u=(i=new Common.cG,i.Id="menuCoauthors",i.MaxWidth="220px",i.MenuSectionList=[],i),t,f=(t=new Common.cl,t.Id="msCoauthors",t.ControlsId="msCoauthorsControls",t.DisplayMode=this.G(),t.ControlList=h,t);return Common.a.a.a("WordEditorDisplayPeoplesWellLabelIsEnabled")&&this.i&&(f.Title=$a.he,f.TitleId="menuCoauthorsTitle",f.Theme="Light"),Array.add(u.MenuSectionList,f),Common.a.a.a("DocChatIsEnabled")&&Common.a.a.a("PeoplesWellExtraButtonInfoIsEnabled")&&Common.a.b()&&Common.a.b().a().e()&&(e=[],Array.add(e,this.W()),o=(r=new Common.cl,r.Id="msGroupChat",r.ControlsId="msGroupChatControl",r.ControlList=e,r),Array.add(u.MenuSectionList,o)),Common.a.b()&&Common.a.b().a().e()?n.MenuItems=u:n.PopulationXML=Common.w.f(u),!0},bn:function(n){var t,i;return(Diag.a.a(4482395,325,50,"PeoplesWell: Received user button click"),t=n.MenuItemId,!t)?!1:(i=this.c.c(t),!this.C(t,i,!0))?!1:(this.H(t,i),!0)},bj:function(){var n=this.T();this.d.c(n);this.h&&this.d.a()>=1&&(Diag.a.a(6092429,325,50,"PeoplesWell: User is no longer forever alone."),this.h=!1);this.m=!0},bg:function(){if(!this.l){var n=this;window.setTimeout(function(){n.j();n.l=!1},3e3);this.l=!0}},T:function(){var n=null,r;n||(n=this.F()||[]);for(var i=n,u=i.length,t=0;t<u;++t)r=i[t],this.bl(r);return n},bl:function(n){n.a()||n.j(Common.y.a().a);n.d()||n.m("Anonymous user");n.b()||n.i(new Common.dl(0));n.e()||n.k("#cccccc");n.h()||n.l(0)},bm:function(n){var t=[];return Array.addRange(t,n),t.sort(RealtimePresenceUI.b.a),t},bk:function(){Common.a.a.a("CoauthorGalleryTelemetryIsEnabled")&&Common.a.c().a(691867605,2147483648,this.z);this.I();this.o=!0;this.j()},bf:function(n,t,i,r,u){return this.p.d(u.RenderTime),32},a:function(){return this.p.a},j:function(){(this.o||(this.p.d((new Date).getTime()),Diag.a.a(42567504,325,50,"We are trying to render the coauthor gallery before we are ready to record the render time"),!this.E()))&&((this.bj(),this.E()&&this.h)||this.y())},dispose:function(){this.g&&(this.g.c(this.k),this.g=null);this.f&&(this.f.c(this.k),this.f=null)}};RealtimePresenceUI.a=function(n,t,i,r,u){var f,e;this.a=n;this.d=t;this.e=u;f=this;this.c=i||function(){return null};e=this;this.b=r||function(){return null}};RealtimePresenceUI.a.a=function(n,t,i,r,u){return new RealtimePresenceUI.a(n,t,i,r,u)};RealtimePresenceUI.a.prototype={a:null,d:null,c:null,b:null,e:!1};RealtimePresenceUI.g=function(n){this.d=new($$sc.v.$$(Array));this.e=n};RealtimePresenceUI.g.prototype={e:null,f:null,c:function(n){var i;this.k();this.l(n);for(var r=n,u=r.length,t=0;t<u;++t)i=r[t],i.a()!==this.e&&this.h(i)},b:function(){for(var n=new Array(0),t=this.d.k().$$ge(),i,r;t.$$mn();)i=t.$$cu(),r=this.j(i),Array.add(n,r);return n},a:function(){return this.d.e},i:function(n,t){n=n.toUpperCase();var i,r,u;(u=this.d.f(n,r={val:i},null),i=r.val,u)||(i=new Array(0),this.d.b(n,i));Array.add(i,t)},k:function(){this.d=new($$sc.v.$$(Array))},l:function(n){for(var i,r=n,u=r.length,t=0;t<u;++t)if(i=r[t],i.a()===this.e){this.f=i;return}}};RealtimePresenceUI.e=function(){};RealtimePresenceUI.e.a=function(n,t,i){return i?new RealtimePresenceUI.c(n,t):new RealtimePresenceUI.d(n)};RealtimePresenceUI.c=function(n,t){RealtimePresenceUI.c.initializeBase(this,[n]);this.g=t};RealtimePresenceUI.c.prototype={g:null,h:function(n){if(n.f()||!n.c()){this.i(n.a(),n);return}this.f&&$$sc.e.a().a(this.f.c(),n.c())||this.i(n.c(),n)},j:function(n){for(var r,t,u=new Date(0),f=n.length>0?n[0]:null,e=n,o=e.length,i=0;i<o;++i)(r=e[i],t=this.g(r.n),t)&&u.getTime()<t.b.getTime()&&(u=t.b,f=r);return f}};RealtimePresenceUI.d=function(n){RealtimePresenceUI.d.initializeBase(this,[n])};RealtimePresenceUI.d.prototype={h:function(n){this.i(n.a(),n)},j:function(n){return n[0]}};RealtimePresenceUI.b.registerClass("RealtimePresenceUI.b",null,Common.dX,Sys.IDisposable);RealtimePresenceUI.g.registerClass("RealtimePresenceUI.g");RealtimePresenceUI.c.registerClass("RealtimePresenceUI.c",RealtimePresenceUI.g);RealtimePresenceUI.d.registerClass("RealtimePresenceUI.d",RealtimePresenceUI.g);Type.registerNamespace("_Ewa");_Ewa.Po=function(n){this.o=Function.createDelegate(this,this.u);this.p=Function.createDelegate(this,this.v);this.m=Function.createDelegate(this,this.y);this.j=Function.createDelegate(this,this.n);this.k=Function.createDelegate(this,this.w);this.l=Function.createDelegate(this,this.x);_Ewa.Po.initializeBase(this,[!1]);this.e=n;this.e.a(362)&&(Diag.a.b(40461393,0,!!this.e.c(),"NamedSheetViewConversionManager ctor: EwaControl.SessionStateManager should not be null"),this.e.G(this.l),this.e.c().D(this.k),this.e.c().cn(this.j),this.e.c().r(this.m),this.e.c().q()&&this.n(this,Sys.EventArgs.Empty))};_Ewa.Po.prototype={f:null,h:null,g:!1,i:!1,e:null,a:function(n){this.dQ("SVCU",n)},b:function(n){this.dR("SVCU",n)},dispose:function(){this.f=null;this.h=null;this.e&&this.e.H(this.l);this.e.c()&&(this.e.c().z(this.k),this.e.c().cF(this.j),this.e.c().t(this.m));this.e=null;_Ewa.ce.prototype.dispose.call(this)},d:function(n){return this.g?null:this.q(n,this.h,"ConvertPresencePublicToPrivate")},c:function(n){return this.g?null:this.q(n,this.f,"ConvertPresencePrivateToPublic")},z:function(n){if(!n){Diag.a.a(40993282,0,10,"NamedSheetViewConversionManager.ProcessConversionEntries: conversionEntries can be empty but not null");return}this.t(n);this.f=n;this.h=this.r(this.f)},y:function(){var t=this.e.c().l(),n,u,e;if(t&&t.SheetChanges)for(var o=t.SheetChanges,c=o.length,i=0;i<c;++i)if(n=o[i],n.Type===2){if(this.f)for(var s=this.f,l=s.length,r=0;r<l;++r)u=s[r],u.Range.SheetName===n.Name&&(u.Range.SheetName=n.NewName);if(this.h)for(var h=this.h,a=h.length,f=0;f<a;++f)e=h[f],e.Range.SheetName===n.Name&&(e.Range.SheetName=n.NewName)}},w:function(){Diag.a.a(50657436,0,50,"NamedSheetViewConversionManager.OnGridLoaded");this.i=!1;this.n(this,Sys.EventArgs.Empty)},x:function(){Diag.a.a(50657437,0,50,"NamedSheetViewConversionManager.OnWorkbookClosing");this.i=!0},n:function(){if(Diag.a.a(50620166,0,50,"NamedSheetViewConversionManager.OnConversionOutdatedEvent: triggered with version [{0}]",this.e.c().bu()),!this.e.k()||!this.e.c().a()||this.e.c().bF()||this.i||this.e.c().bu()===-2){Diag.a.a(50467170,0,50,"NamedSheetViewConversionManager.OnConversionOutdatedEvent: Request skipped [Edit Mode: {0}] [IsSessionActive: {1}] [HasRaisedSessionEnded: {2}] [WorkbookClosed: {3}]",this.e.k(),this.e.c().a(),this.e.c().bF(),this.i);return}this.f=null;this.h=null;var n=this.e.d().a().b(!1);_Ewa.QL.a(this.e.d().a(),this.p,this.o,null,n)},v:function(n){var t,r,i;if(_Ewa.h.e(n.Errors)){this.g=!0;t=[-1100324317,-1857233882];_Ewa.h.c(n.Errors,t)&&Diag.a.a(40993283,0,10,"NamedSheetViewConversionManager.OnGetNamedSheetViewConversionSuccess Errors: [{0}]",_Ewa.h.a(n.Errors,","));r=_Ewa.h.g(n.Errors,t,"NamedSheetViewConversionManager:OnGetNamedSheetViewConversionSuccess");this.e.c().s(r);return}this.g=!1;i=n.Result;this.e.c().cd(i.ConversionVersion);this.z(i.NamedSheetViewConversionEntries);this.A()},u:function(n){this.g=!0;var t=n.b,i=_Ewa.W.a(t);Diag.a.a(40993284,0,10,"NamedSheetViewConversionManager.OnGetNamedSheetViewConversionFailure: Errors: [{0}].",_Ewa.h.a(i,","))},A:function(){Diag.a.a(40461394,0,50,"NamedSheetViewConversionManager.RaiseConversionUpdatedEvent: new version is update on client from server");this.dP("SVCU",null,null)},q:function(n,t,i){var r,u,f,e,h;if(!t||!t.length)return Diag.a.a(40993285,0,50,"NamedSheetViewConversionManager.{0}: skipping convert due to {1} ConversionEntries. ",i,t?"empty":"null"),n;for(var c=n,a=c.length,o=0;o<a;++o){r=c[o];for(var l=t,v=l.length,s=0;s<v;++s)if((u=l[s],u.IsRow)&&_Ewa.fA.a(u.Range,r)&&(!(r.FirstRow<=u.Range.FirstRow)||!(r.LastRow>=u.Range.LastRow)))if(f={},f.SheetName=r.SheetName,f.FirstRow=f.LastRow=r.FirstRow,f.FirstColumn=f.LastColumn=r.FirstColumn,_Ewa.fA.a(u.Range,f)){if(e=-1,h=-1,e=r.FirstRow-u.Range.FirstRow,e<0||e>=u.ConversionMap.length){Diag.a.a(40993286,0,10,"NamedSheetViewConversionManager.ConvertRanges: invalid mapIndex after adjust. Index: [{0}], ConversionMap.Length: {1}",e,u.ConversionMap.length);continue}else h=u.ConversionMap[e]-e;r.FirstRow+=h;r.LastRow=r.FirstRow;r.LastColumn=Math.min(r.LastColumn,u.Range.LastColumn)}else r.FirstRow<u.Range.FirstRow&&r.LastRow>=u.Range.FirstRow?r.LastRow=u.Range.FirstRow-1:r.LastColumn>=u.Range.FirstColumn&&(r.LastColumn=u.Range.FirstColumn-1);(r.FirstRow<0||r.FirstRow>1048575)&&(r.FirstRow=Math.max(Math.min(r.FirstRow,1048575),0));(r.LastRow<0||r.LastRow>1048575)&&(r.LastRow=Math.max(Math.min(r.LastRow,1048575),0));(r.FirstColumn<0||r.FirstColumn>16383)&&(r.FirstColumn=Math.max(Math.min(r.FirstColumn,16383),0));(r.LastColumn<0||r.LastColumn>16383)&&(r.LastColumn=Math.max(Math.min(r.LastColumn,16383),0))}return n},r:function(n){var u,t,i,r;if(!n||!n.length)return Diag.a.a(40993287,0,50,"NamedSheetViewConversionManager.CreateInverseConversionEntries: skip creating inverse due to {0} ConversionEntries. ",this.f?"empty":"null"),n;for(u=new Array(n.length),t=0;t<n.length;++t){for(i=new _Ewa.Bu,i.Range=n[t].Range,i.IsRow=n[t].IsRow,i.ConversionMap=new Array(n[t].ConversionMap.length),i.IsRow||(this.g=!0,Diag.a.a(41185634,0,10,"NamedSheetViewConversionManager.CreateInverseConversionEntries: adjusting presence against column sort map is NYI.")),r=0;r<n[t].ConversionMap.length;++r)i.ConversionMap[n[t].ConversionMap[r]]=r;u[n.length-t-1]=i}return u},t:function(n){var t,r;if(n&&n.length)for(var u=n,f=u.length,i=0;i<f;++i)t=u[i],this.s(t),r=t.IsRow?t.Range.LastRow-t.Range.FirstRow+1:t.Range.LastColumn-t.Range.FirstColumn+1,t.ConversionMap.length!==r&&(Diag.a.b(41435473,0,!1,"NamedSheetViewConversionManager.DecompressEntries: decompressed conversion map doesn't match expected size - Expected: [{0}] | Actual: [{1}]",r,t.ConversionMap.length),this.g=!0)},s:function(n){var t=n.ConversionMap,r,i,f,e,u;if(t&&t.length){if(t[0]<0){Diag.a.b(41435474,0,!1,"NamedSheetViewConversionManager.DecompressConversionMap: conversionMap starts with a negative number");this.g=!0;return}for(r=[],i=0;i<t.length;++i)if(t[i]<0)for(f=t[i-1],e=t[i]*-1,u=1;u<=e;++u)Array.add(r,f+u);else Array.add(r,t[i]);n.ConversionMap=r}}};_Ewa.bgw=function(){};_Ewa.bgw.registerInterface("_Ewa.bgw");_Ewa.bgx=function(){};_Ewa.bgx.registerInterface("_Ewa.bgx");_Ewa.yw=function(n){this.c=n};_Ewa.yw.prototype={c:null,a:function(){return $$sc.a.a(Common.gq,this.c.c().bG()?0:1)},b:function(){return $$sc.a.a(Number,0)}};_Ewa.QH=function(n,t,i){this.a(null);this.d=n;this.g=t;this.h=i;this.e=new _Ewa.rh(_Ewa.b.a(this.g),this.d.User.UserID,this.d.User.UserName,this.d.UserColor,null,i,this.g,this.d.IsAnonymous)};_Ewa.QH.prototype={g:null,e:null,d:null,h:null,f:null,a:function(n){return this.f=n,this.f&&this.h.S(this.f.cj()),n},i:null,dispose:function(){this.l();System.a.a(this.e);this.a(null);this.d=null;this.g=null;this.i=null},k:function(n){this.e.N(n.e)},l:function(){this.f&&this.d&&this.d.User&&(this.f.bt(!1,this.d.User.UserID,null),this.e.o(!0))},b:function(){this.f&&this.d&&this.d.User&&(this.f.bt(!0,this.d.User.UserID,this.d.UserColor),this.e.v())},j:function(n){this.e.t(n);this.e.e(n,!0)},c:function(n,t){this.e.O(null,t?32:31,n)}};_Ewa.rg=function(){_Ewa.rg.initializeBase(this,[!1])};_Ewa.rg.a=function(n,t){var i=n.b.d();System.a.b(n.d());System.a.b([n.b]);n.b=null;n.b=new _Ewa.yA(t);n.n([]);n.y(t);n.o(i)};_Ewa.rg.prototype={b:null,k:null,d:function(){return this.k},n:function(n){return this.k=n,n},l:null,g:function(){return this.l},y:function(n){return this.l=n,n},a:function(){return this.b.d()},o:function(n){return this.b.e(n),n},x:function(){},h:function(){return null},m:function(){return null},p:function(){},q:function(){},z:function(){}};_Ewa.QI=function(n){_Ewa.QI.initializeBase(this);this.f=n;this.e()};_Ewa.QI.prototype={f:null,a:null,p:function(){this.d(this.a||(this.a=new _Ewa.Po(this.f)))}};_Ewa.fW=function(n,t,i){var r,e,u,f;for(this.q=Function.createDelegate(this,this.v),this.n=Function.createDelegate(this,this.u),_Ewa.fW.initializeBase(this,[!1]),this.l=n,this.t=n.d(),this.o=!1,this.k=new _Ewa.v(!0),r=0;r<4;r++)e=this.l.g().u(i,_Ewa.fW.a()[r])||_Ewa.fW.a()[r]===1,e&&(u=t.a(document.createElement("div"),!1),f=n.n(_Ewa.fW.a()[r]).j(),f.insertBefore(u.a(),f.firstChild),this.k.c(Enum.toString(_Ewa.oM,_Ewa.fW.a()[r]),u))};_Ewa.fW.a=function(){return _Ewa.fW.b||(_Ewa.fW.b=[1,3,2,4])};_Ewa.fW.prototype={l:null,t:!1,m:null,o:!1,s:null,p:!1,k:null,a:function(){return null},c:function(){var n=_Ewa.v.a(this.k.b,Enum.toString(_Ewa.oM,_Ewa.fW.a()[0]),null);return n?n.c():null},dispose:function(){var n,t,i;if(this.k.a.length>0){this.e();n=this.k.b;for(t in n)i={key:t,value:n[t]},i.value.dispose()}this.l=null;this.k.f();_Ewa.ce.prototype.dispose.call(this)},i:function(){var t=this.k.b,n,i;for(n in t)i={key:n,value:t[n]},i.value.i()},h:function(){var n,t,i;this.r();n=this.k.b;for(t in n)i={key:t,value:n[t]},i.value.h()},e:function(){var n,t,i;this.w();n=this.k.b;for(t in n)i={key:t,value:n[t]},i.value.e()},b:function(n){var i=this.k.b,t,r;for(t in i)r={key:t,value:i[t]},r.value.b(n)},f:function(n){var i=this.k.b,t,r;for(t in i)r={key:t,value:i[t]},r.value.f(n)},g:function(n,t){var r=this.k.b,i,u;for(i in r)u={key:i,value:r[i]},u.value.g(n,t)},d:function(n){var t,i,r;this.o!==n&&(this.o=n,t=_Ewa.v.a(this.k.b,Enum.toString(_Ewa.oM,_Ewa.fW.a()[0]),null),this.m&&t&&(i=_Ewa.a.G(t.a())/2,r=this.o?this.m.x+14+i:this.m.x-14-i,this.j(r,this.m.y)))},j:function(n,t){var r=this.k.b;for(var u in r){var f={key:u,value:r[u]},o=Enum.parse(_Ewa.oM,f.key),e=this.l.n(o),i=_Ewa.yx.a(e,new Sys.UI.Point(n,t),!1);this.m=new Sys.UI.Point(n,t);i.x<0&&(i.x+=e.j().scrollLeft);_Ewa.a.u(f.value.a(),i.x,i.y,!1,this.t)}},u:function(){this.r()},v:function(){this.r()},r:function(){this.m&&(this.j(this.m.x,this.m.y),this.p||(this.p=!0,this.l.b().j(this.n),this.l.b().d(this.n),this.l.i().d(this.q)))},w:function(){this.p&&(this.l.b().l(this.n),this.l.b().c(this.n),this.l.i().b(this.q))}};_Ewa.rh=function(n,t,i,r,u,f,e,o){this.I=Function.createDelegate(this,this.R);this.J=Function.createDelegate(this,this.S);this.K=Function.createDelegate(this,this.T);this.H=Function.createDelegate(this,this.Q);this.w={};_Ewa.rh.initializeBase(this,[!1]);o=!!(o|i===_Ewa.ClientStringManager.a().c(82));this.G=new Common.dg(t,i,r,new Common.dl(0),null,null,null,null,o,!1,!1,0,null,0);this.D=n;this.y=t;this.F=u;this.B=f;this.M=e};_Ewa.rh.a=function(n,t){return n.toString()+t.toString()};_Ewa.rh.prototype={C:null,F:null,L:0,D:null,B:null,z:null,E:null,M:null,j:function(n){this.dQ("hidePresenceTooltip",n)},p:function(n){this.dR("hidePresenceTooltip",n)},m:function(n){this.dQ("showPresenceTooltip",n)},r:function(n){this.dR("showPresenceTooltip",n)},l:function(n){this.dQ("showFullPresenceTooltip",n)},q:function(n){this.dR("showFullPresenceTooltip",n)},k:function(n){this.dQ("presenceChanged",n)},s:function(n){this.dR("presenceChanged",n)},y:null,a:function(){return this.y},G:null,c:function(){return this.G},x:0,b:function(){return this.x},i:function(){return this.C},h:function(){return this.C||this.E?_Ewa.yx.a(this.D.n(this.x),this.A(this.x).h(),!0):null},g:function(){return this.A(this.x).g()},t:function(n){var i=this.w,t,r;for(t in i)r={key:t,value:i[t]},r.value.t(n);return n},dispose:function(){var t,i,r,n;this.dP("hidePresenceTooltip",null,null);this.dP("presenceChanged",null,null);this.B&&this.B.O(this.y);t=this.w;for(i in t)r={key:i,value:t[i]},n=r.value,n.p(this.H),n.r(this.K),n.q(this.J),n.s(this.I),n.dispose();this.w=null;this.D=null;this.F=null;this.C=null;this.B=null;_Ewa.ce.prototype.dispose.call(this)},O:function(n,t,i){n?(this.C=_Ewa.g.b(n),this.x=this.D.g().b(this.C.X())):i?(this.E=i,this.x=i.e().D()):this.x=1;this.L=t;this.A(this.x);this.u(n,i)},u:function(n,t){var r=this.w,i,u;for(i in r)u={key:i,value:r[i]},u.value.u(n,t)},o:function(n){var t,i,r;this.A(this.x).o(n);t=this.w;for(i in t)r={key:i,value:t[i]},r.value.o(!1)},N:function(n){var r=this.w,t,u,i;for(t in r)u={key:t,value:r[t]},i=u.value,i.n(n.A(i.b()))},n:function(n){this.A(n.b()).n(n)},d:function(){var n=this.A(this.x).d(),i=this.w,t,r;for(t in i)r={key:t,value:i[t]},n=!!(n|r.value.d());return n},e:function(n,t){var i,r,u;this.B.t(this);this.A(this.x).e(n,t);i=this.w;for(r in i)u={key:r,value:i[r]},u.value.e(n,!1)},f:function(n){var i=this.w,t,r;for(t in i)r={key:t,value:i[t]},r.value.f(n)},v:function(){var t=this.w,n,i;for(n in t)i={key:n,value:t[n]},i.value.v();this.B.t(this)},A:function(n){return this.P(n,this.L)},P:function(n,t){var u=this.F?this.F.e(t,n,0).a:this.E?this.E.A():null,r=_Ewa.rh.a(t,n),i=_Ewa.v.a(this.w,r,null);return i||(i=new _Ewa.QN(u,this.D,this.G,n,this.M),this.w[r]=i,i.j(this.H),i.m(this.K),i.l(this.J),i.k(this.I)),i},Q:function(n){this.z&&this.z!==n||(this.z=null,this.o(!1));this.dP("hidePresenceTooltip",null,null)},T:function(n){this.z&&this.z!==n||(this.z=null,this.e(!0,!1));this.dP("showPresenceTooltip",null,null)},S:function(n){this.z||this.dP("showFullPresenceTooltip",null,null);this.z=n},R:function(){this.o(!1);this.dP("presenceChanged",null,null)}};_Ewa.yy=function(n){this.f=Function.createDelegate(this,this.h);this.e=new Common.ba;this.d=n;this.d.c().U(this.f)};_Ewa.yy.prototype={d:null,g:!1,dispose:function(){this.g||(this.d&&this.d.c()&&this.d.c().W(this.f),System.a.b([this.e]),this.e=null,this.d=null,this.g=!0)},b:function(n){this.e.m("UU",n)},c:function(n){this.e.n("UU",n)},a:function(){for(var n,u,t=[],r=this.d.c().x(),f=r.length,i=0;i<f;++i)n=r[i],u=new Common.dg(n.User.UserID,n.User.UserName,n.UserColor,new Common.dl(1),null,n.UserEmail,null,null,!1,!1,!1,n.JoinCoauthTime,null,0),Array.add(t,u);return Diag.a.a(42481440,0,50,"PeopleInfoProvider.GetAllUsers: Count: [{0}]",t.length),t},h:function(){Diag.a.a(42481442,0,50,"PeopleInfoProvider.OnUserListUpdated fired");this.e.k("UU",this,null)}};_Ewa.QJ=function(){};_Ewa.QJ.prototype={a:function(n){var f=n.key,i=n.value,r,t,u;return i?(r=i.SupportsChat?4:0,u=(t=new Common.dg,t.n=f,t.u=i.ChatThreadId,t.t=i.ChatThreadDiscoveryUri,t.v=i.InChat,t.s=i.Cid,t.q=new Common.dl(r),t),u):null}};_Ewa.ri=function(){_Ewa.ri.initializeBase(this);this.e()};_Ewa.ri.a=function(n){n.b().b(_Ewa.wZ.$$(Common.eB),159,new _Ewa.ri)};_Ewa.ri.prototype={a:null,p:function(){this.d(this.a||(this.a=new _Ewa.QJ))}};_Ewa.fB=function(n,t,i){_Ewa.fB.initializeBase(this,[t,_Ewa.b.a(t),!0,!1,n.User.UserID]);_Ewa.fB.a||(_Ewa.fB.a={});this.y=n;this.W=t;this.t=new _Ewa.rh(this.s,this.y.User.UserID,this.y.User.UserName,this.y.UserColor,this,i,this.W,this.y.IsAnonymous)};_Ewa.fB.b=function(n,t,i){if(i){if(t===n.firstChild)return;n.removeChild(t);n.insertBefore(t,n.firstChild)}else{if(t===n.lastChild)return;n.removeChild(t);n.appendChild(t)}};_Ewa.fB.prototype={y:null,U:31,A:!1,I:!1,W:null,t:null,dispose:function(){var t,i,r,n;System.a.a(this.t);_Ewa.gF.prototype.dispose.call(this);t=_Ewa.fB.a;for(i in t)r={key:i,value:t[i]},n=r.value,n&&!n.children.length&&(_Ewa.a.h(n),_Ewa.fB.a[r.key]=null)},V:function(n){this.t.N(n.t)},bl:function(n){this.I||(this.t.t(n),this.t.e(n,!0));this.A=n&&this.I},X:function(n,t){this.t.O(n,t?32:31,null);this.A=!1},bI:function(n){this.bJ();this.U=n;this.c([n],null,null)},bF:function(n){this.bG();this.b([n])},bd:function(n,t,i){var u,e,r,f;i.className="ewr-cell-presence-highlight-all";i.style.borderColor=this.y.UserColor;u=document.createElement("div");n!==31&&n!==32&&(u.style.backgroundColor=this.y.UserColor);i.appendChild(u);e=["ewr-cell-presence-highlight-fill","ewr-cell-presence-highlight-edit"];u.className=e[n-31];r=_Ewa.v.a(_Ewa.fB.a,t.toString(),null);r||(f=this.s.n(t).j(),r=document.createElement("div"),f.insertBefore(r,f.firstChild),_Ewa.fB.a[t.toString()]=r);r.appendChild(i)},be:function(){},bh:function(n,t,i,r){var f=this.bE(r,n,t),u,e,o;_Ewa.dz.a(i,this.s.d(),f.a.a+"px");i.width=f.c()+"px";i.top=f.a.b+"px";i.height=f.d()+"px";u=t.a;e=u.parentNode;n===32?_Ewa.fB.b(e,u,!1):n===31&&(o=this.e(32,1,0),r.g(o.l)?_Ewa.fB.b(e,u,!1):_Ewa.fB.b(e,u,!0));this.bH(n)},bj:function(){return!1},bE:function(n,t,i){var r=n.a.b+this.F(i,!1),u=n.a.a+this.F(i,!0)+_Ewa.Y.i(i.a.parentNode.parentNode,this.s.d()),f=n.c(),e=n.d()+1;return u<1&&u>=-1&&t===31&&(f-=1-u,u=1),r<1&&r>=-1&&t===31&&(e-=1-r,r=1),f=Math.max(0,f-1),e=Math.max(0,e-2),new _Ewa.X(u,r,f,e)},bH:function(n){this.t.v();this.U=n;this.I=!1;this.A&&this.bl(!0);this.A=!1},bG:function(){this.I||(this.t.o(!0),this.A=!1)},bJ:function(){this.t.e(!0,!0)}};_Ewa.yz=function(n){this.v=Function.createDelegate(this,this.Q);this.u=Function.createDelegate(this,this.E);this.r=Function.createDelegate(this,this.K);this.s=Function.createDelegate(this,this.L);this.p=Function.createDelegate(this,this.I);this.o=Function.createDelegate(this,this.H);this.h=Function.createDelegate(this,this.G);this.q=Function.createDelegate(this,this.J);this.k="ewaboot_doughboywhite20";this.f=20;this.a=_Ewa.b.a(n);this.c=n;this.g={};this.b={};this.d={};this.e={};this.c.e()&&this.c.e().d(this.q);this.x()};_Ewa.yz.a=function(n,t,i){return n.x.toString()+"-"+n.y.toString()+"-"+t.toString()+"-"+i.a.toString()+"-"+i.b.toString()};_Ewa.yz.prototype={f:16,g:null,d:null,b:null,e:null,i:!1,k:null,a:null,c:null,l:null,j:null,dispose:function(){this.N();this.w();this.c&&this.c.e()&&this.c.e().e(this.q);this.a=null},N:function(){this.i&&(this.a.b().l(this.h),this.a.b().c(this.h),this.a.i().b(this.o),this.i=!1)},O:function(n){var t=this.d[n],i=this.b[n];t&&this.A(t);i&&this.m(i,t.c().n,this.c,t.b(),t.a());delete this.b[n];delete this.d[n];delete this.e[n]},t:function(n){var t=n.a(),i=this.d[t];i||(this.F(n),this.d[t]=n)},R:function(n){var u=n.g(),i=n.a(),t=this.y(n.h(),n.b(),n.i()),r=this.b[i];t&&t!==r&&(n.f(t),this.b[i]=t,this.d[i]=n,this.e[i]&&t.d(this.e[i]));r!==t&&r&&this.m(r,n.c().n,this.c,n.b(),n.a());!this.i&&this.a&&(this.a.b().j(this.h),this.a.b().d(this.h),this.a.i().d(this.o),this.i=!0)},m:function(n,t,i,r,u){var e,f,o;n.f(t);this.c.isChangeGateEnabled("OfficeVSO:3663630_ModernPresenceUxPerf")&&(e=this.b[u],e===n&&delete this.b[u]);n.c()&&n.c().length||(f=n.s,f&&delete this.g[f],this.c.isChangeGateEnabled("OfficeVSO:3663630_ModernPresenceUxPerf")||(o=this.b[u],o===n&&delete this.b[u]),n.dispose())},A:function(n){n&&(n.p(this.p),n.r(this.s),n.q(this.r),n.f(null))},F:function(n){n.j(this.p);n.m(this.s);n.l(this.r)},I:function(n){var t=n,i=this.b[t.a()];i&&this.m(i,t.c().n,this.c,t.b(),t.a())},L:function(n){this.B(!1,n)},K:function(n){this.B(!0,n)},B:function(n,t){var i,r;t.g()||this.t(t);this.R(t);i=this.b[t.a()];i&&(r=t.i(),i.b(t.c()),t.d()?n?i.h():i.i():i.e())},y:function(n,t,i){var u,e,f,r;return n?(u=this.D(n,t),e=this.a.n(t).v(),f=_Ewa.yz.a(u,t,e).toString(),r=_Ewa.v.a(this.g,f,null),r||(r=new _Ewa.fW(this.a,this.l,i),r.j(u.x,u.y),r.s=f,this.g[f]=r),r):null},D:function(n,t){var f=this.a.n(t).P(),i=this.a.n(t).v(),r=_Ewa.eC.a(t,f.a),e=Math.max(i.a,n.x-this.f/2-2),u;return e=Math.min(Math.max(r.a+i.a,e),r.a+i.a+f.c()-this.f),u=Math.max(i.b,n.y-this.f/2+1),u=Math.min(Math.max(r.b+i.b,u),r.b+i.b+f.d()-this.f),new Sys.UI.Point(e,u)},w:function(){var r=this.d,n,u,t,i,f;for(n in r)u={key:n,value:r[n]},this.A(u.value);t=this.g;for(i in t)f={key:i,value:t[i]},f.value.dispose();this.b={};this.d={};this.g={};this.e={};System.a.a(this.j);this.j=null},G:function(){this.C()},H:function(){this.C()},J:function(){this.x();this.w()},E:function(n){for(var i=_Ewa.a.m(n.a()),f=new _Ewa.X(i.x,i.y,i.width,i.height),u=_Ewa.fW.a(),e=u.length,r=0;r<e;++r){var o=u[r],s=this.a.n(o),t=_Ewa.a.i(s.j()),h=new _Ewa.X(t.x,t.y,t.width,t.height);if(h.i(f))return t}return null},x:function(){var n=new Common.App.CollabControls.h;n.a(0,"ewaboot_presenceheadswhite");n.a(1,this.k);n.a(12,49);n.a(6,this.f);this.a&&(n.a(4,_Ewa.t.a(3)),n.a(5,_Ewa.t.a(3)),n.a(8,this.a.d()));n.a(18,!0);this.l=new Common.App.CollabControls.g(n);n.a(16,this.u)},P:function(n,t){var i=new Common.App.CollabControls.h;i.a(0,n?"ewaboot_presenceheadswhite":t);i.a(1,n===1?t:this.k);i.a(12,n===12?Number.parseInvariant(t.toString()):49);i.a(6,n===6?t:this.f);this.a&&(i.a(4,n===4?t:_Ewa.t.a(3)),i.a(5,n===5?t:_Ewa.t.a(3)),i.a(8,n===8?t:this.a.d()));this.l=new Common.App.CollabControls.g(i)},S:function(n){this.P(12,n)},C:function(){this.j=_Ewa.de.a(this.v,100,_Ewa.m.bS,this.j)},Q:function(){var u=this.d,r,f,n;for(r in u)if(f={key:r,value:u[r]},n=f.value,n){var e=n.d(),i=this.b[n.a()],t=e?this.y(n.h(),n.b(),n.i()):null;t!==i?(i&&this.m(i,n.c().n,this.c,n.b(),n.a()),t&&e&&(t.b(n.c()),this.b[n.a()]=t,n.f(t),this.z(t,n))):this.z(i,n)}},z:function(n,t){this.e[t.a()]&&n.d(this.e[t.a()]);t.d()?t.e(!0,!0):t.e(!1,!0)},n:function(n,t){this.e[n]=t;var i=this.b[n];i&&i.d(t)},M:function(n,t){var i=this.b[n];i&&i.g(n,t)}};_Ewa.og=function(n,t,i,r,u){this.F=Function.createDelegate(this,this.bq);this.H=Function.createDelegate(this,this.bs);this.G=Function.createDelegate(this,this.br);this.E=Function.createDelegate(this,this.bp);this.I=Function.createDelegate(this,this.bc);this.R=Function.createDelegate(this,this.bm);this.K=Function.createDelegate(this,this.bu);this.L=Function.createDelegate(this,this.by);this.D=Function.createDelegate(this,this.bo);this.C=Function.createDelegate(this,this.bn);this.J=Function.createDelegate(this,this.bt);this.h={};_Ewa.og.initializeBase(this,[!1]);this.t={};this.u={};this.m={};this.k={};this.g=n;this.v=r;this.l=t;this.i=i;this.bj();this.n=new _Ewa.yz(n);this.g.e()&&this.g.e().d(this.J);this.l.c(this.C);this.l.d(this.D);n.d()&&this.g.d().i(this.L);this.j=[];this.l.a();n.b().b(_Ewa.nQ,25,this);this.o=!1;this.g.G(this.K);this.q=_Ewa.x.a().b(this.R,this.O/2,_Ewa.m.bT,!0,!1);this.w=u};_Ewa.og.a=function(n,t,i,r){var u;if(!r||!r.a()||!r.a().Object)return!1;for(var e=r.a().Object,o=e.length,f=0;f<o;++f)if(u=e[f],n&&u&&u.ObjectId&&!u.ObjectId.localeCompare(n))return Array.add(u.ObjectPresenceType===1?i:t,r.b.a.User),!0;return!1};_Ewa.og.prototype={q:null,g:null,v:null,s:0,r:0,j:null,n:null,p:null,l:null,o:!1,y:null,O:3e4,m:null,t:null,u:null,x:!1,Q:!0,w:null,A:null,d:function(n){this.dQ("pcek",n)},f:function(n){this.dR("pcek",n)},i:null,c:function(){return this.h},k:null,a:function(n){var t=this.h[n];t&&this.bd(n,!1)},bw:function(n){this.p&&this.p!==n.b()&&(this.Q=!1);this.i.a(n);this.p=n.b()},e:function(n,t,i,r){var u,f,o,e,s;i.val=[];r.val=[];u=this.h;for(f in u)o={key:f,value:u[f]},e=o.value,t?(s=_Ewa.g.B(n,this.g),this.Y(s,i.val,r.val,e)):this.X(n,i.val,r.val,e)},b:function(n,t,i,r,u){var f=this.h[u];f&&(t?this.Y(n,i,r,f):this.X(n,i,r,f))},dispose:function(){var n,t,i;if(this.bx(),this.g&&(this.g.e()&&this.g.e().e(this.J),this.g.d()&&this.g.d().j(this.L),this.g.H(this.K)),this.l&&(this.l.e(this.C),this.l.f(this.D)),this.q&&(this.q.dispose(),this.q=null),this.h){n=this.h;for(t in n)i={key:t,value:n[t]},i.value.dispose()}System.a.b([this.i,this.n]);this.U();this.i=null;this.g=null;this.h=null;Array.clear(this.j);_Ewa.ce.prototype.dispose.call(this)},bx:function(){this.i&&(this.i.k(this.I),this.i.j(this.E),this.i.l(this.G),this.i.m(this.H));this.v.b(this.F)},bp:function(){var i=this.k,t,r,n;for(t in i)r={key:t,value:i[t]},n=r.key,this.S(n)?(this.z(n,!0),delete this.m[n],delete this.k[n]):Diag.a.a(20303883,0,50,"PresenceView.OnEcsUserListChanged: pending userId=[{0}] still not updated",n)},bc:function(n,t){var h={},u,e,c,l,a,i,f,r,b,o,k,v,s,y,p,w,d,g;if(h.UpdatedCount=t.b?Object.keys(t.b).length:0,h.DisconnectedCount=t.a?t.a.length:0,_Ewa.bl.a(this.g).a(_Ewa.z.l,h,null,!1),u=null,this.g.o()&&(u=this.g.o().b("ModelUpdate","PresenceRendering"),u.d()),e={},t.b){this.o||(this.P(!0),this.o=!0);c=t.b;for(l in c)(a={key:l,value:c[l]},i=a.key,this.u[i]=_Ewa.u.a().a(),f=a.value,this.V(i,new Date),this.bf(f),i!==this.p)&&(r=this.h[i],r||(this.S(i)?this.z(i,!0):(i in this.k?Diag.a.a(25187144,0,50,"PresenceView.OnSelectionPresenceChanged: userId=[{0}] already pending update",i):(this.m[i]=_Ewa.u.a().a(),e[i]=1),this.k[i]=!0,b=this.bi(i),this.h[i]=this.W(b)),r=this.h[i]),r&&(r.o(f),f.SelectedRange&&f.SelectedRange.length>1?this.s++:this.r++,this.be(i),this.M(r)))}if(t.a)for(o=0,k=t.a.length;o<k;o++)v=t.a[o],this.t[v]=_Ewa.u.a().a(),this.bd(v,!0);(t.a&&t.a.length>0||$$sc.j.a(e).length>0||$$sc.j.a(this.k).length>0)&&(s=[],Array.addRange(s,$$sc.j.a(e)),Array.addRange(s,$$sc.j.a(this.k)),y=this.g.b().a(_Ewa.hs,292,!1,null),y&&y.h(s,t.a));u&&u.a();this.x=!1;p=this.h;for(w in p)if(d={key:w,value:p[w]},g=$$as(_Ewa.rg,d.value).a().CollabMode,!g){this.x=!0;break}this.dP("pcek",t,null)},by:function(n,t){t&&this.g.c().B()&&(t.a.HasAnyNonOcsCoauthor=this.x)},W:function(n){return new _Ewa.oh(n,this.g,this.n)},S:function(n){var t=this.g.c().bK(n),i;return t&&(n in this.h?this.h[n].z(t):(i=this.W(t),this.h[n]=i,this.M(i))),!!t},Y:function(n,t,i,r){var u,f,s;if(n)for(var h=n,l=h.length,e=0;e<l;++e){if(u=h[e],u){if(f=_Ewa.fA.b(u,this.g,1),f&&_Ewa.og.a(f.Q,t,i,r))return;if(f=_Ewa.fA.b(u,this.g,2),f&&_Ewa.og.a(f.Q,t,i,r))return}if(r.a().SelectedRange)for(var c=r.a().SelectedRange,a=c.length,o=0;o<a;++o)if(s=c[o],s&&u&&_Ewa.fA.a(u,s)){Array.add(r.a().PresenceType===1?i:t,r.b.a.User);return}}},X:function(n,t,i,r){n&&_Ewa.og.a(this.bh(n),t,i,r)},bq:function(){var t=new Common.fH({},null),i=this.h;for(var r in i){var u={key:r,value:i[r]},f=u.key,e=u.value,n=e.a();n.SelectedRange=n.SelectedRangeRaw;t.b[f]=n}this.bc(this,t)},bf:function(n){this.g.a(362)&&n.SelectedRange&&(n.SelectedRangeRaw=this.bg(n.SelectedRange),n.SelectedRange=this.v.d(n.SelectedRange))},bg:function(n){for(var i=new Array(n.length),t=0;t<n.length;t++)i[t]=_Ewa.fA.c(n[t]);return i},bh:function(n){if(n)switch(n.a){case 0:var t=this.g.p().bt(n.b);return t?t.Q:null;case 2:return n.E;default:return null}return null},bj:function(){this.i.d(this.I);this.i.e(this.G);this.i.c(this.E);this.i.f(this.H);this.v.a(this.F)},bb:function(n,t,i,r){var u={};u.a=this.g.f().UserSessionId;u.b=n;u.c=i?"PendingUserRemoved":"Non-PendingUserRemoved";u.d=r?"Disconnected":"Inactivity";u.e=t;_Ewa.B.a().a(22,u,!0)},bd:function(n,t){if(n in this.h){this.be(n);var i=this.h[n];i.dispose();delete this.h[n];Diag.a.a(38322520,0,50,"PresenceView.RemovePresenceForUser: userId=[{0}] removed due to inactivity",n);this.bb(n,_Ewa.u.a().a(),!1,t)}n in this.k&&(this.z(n,!1),delete this.m[n],delete this.k[n],Diag.a.a(38322521,0,50,"PresenceView.RemovePresenceForUser: Pending userId=[{0}] removed due to inactivity",n),this.bb(n,_Ewa.u.a().a(),!0,t))},be:function(n){for(var u,t=this.j.length-1;t>=0;t--)if(this.j[t].User.UserID===n){Array.removeAt(this.j,t);for(var r=this.h[n].d(),f=r.length,i=0;i<f;++i)u=r[i],this.n.n(u.t.y,!1);this.B()}},bs:function(){this.Z()},bm:function(){this.y&&_Ewa.ca.a(_Ewa.u.a(),this.y)<this.O||(this.y=_Ewa.u.a().a(),this.N(),this.bk(),this.bl(),this.o||this.P(!1))},bl:function(){(this.r||this.s)&&(this.g.A(-70383382,-1,0,null),Diag.a.a(41477068,0,50,"PresenceView.LogDiscontinuousCountPresenceData: Discontinuous Presence Received with count= [{0}], Continuous Presence Received with count= [{1}]",this.s,this.r));this.r=0;this.s=0},bt:function(){var n,t,i;this.Z();n=this.h;for(t in n)i={key:t,value:n[t]},this.M(i.value)},bu:function(){this.N();this.o||this.P(!1);this.o=!1},U:function(){this.N();this.m=null;this.k=null},N:function(){var t=this.k,n,i;for(n in t)i={key:n,value:t[n]},this.z(i.key,!1)},bk:function(){var f=this.t,n,t,i,r,u;for(n in f)t={key:n,value:f[n]},this.ba(t.key,!0,t.value);i=this.u;for(r in i)u={key:r,value:i[r]},this.ba(u.key,!1,u.value);this.t={};this.u={}},z:function(n,t){var i,r;this.g.k()&&this.g.c().a()&&(i={},i.a=this.g.f().UserSessionId,i.b=n,i.c=t,i.e=!1,i.d=-1,i.f=_Ewa.u.a().a(),this.g.c()&&(i.e=this.g.c().A()),r=this.m[n],r&&(i.d=_Ewa.ca.a(_Ewa.u.a(),r)),_Ewa.B.a().a(20,i,!0))},P:function(n){if(this.g.k()){var t={};t.e=-1;t.f=-1;t.c=!1;t.d=!1;t.b=n;t.a=this.g.f().UserSessionId;this.g.c()&&(t.c=this.g.c().bG(),t.d=this.g.c().A(),t.e=this.g.c().x().length,this.g.c().Y()&&(t.f=_Ewa.ca.a(_Ewa.u.a(),this.g.c().cw())));_Ewa.B.a().a(21,t,!0)}},ba:function(n,t,i){if(this.g.k()){var r={};r.a=this.g.f().UserSessionId;r.b=n;r.c=t;r.d=i;_Ewa.B.a().a(19,r,!0)}},Z:function(){var f=[],e=this.h,i,o,n,t,h,l;for(i in e)if(o={key:i,value:e[i]},n=o.value,this.i.b(n.a())){this.T(f,n);Array.remove(this.j,n.b.a);this.i.g().PresenceType===1&&(t={},t.a=n.a().PresenceType===1?"Editing":"Non-Editing",t.b=this.g.f().UserSessionId,t.c=_Ewa.u.a().a(),_Ewa.B.a().a(18,t,!1));for(var s=n.d(),a=s.length,r=0;r<a;++r)h=s[r],this.n.n(h.t.y,!0)}else for(var c=n.d(),v=c.length,u=0;u<v;++u)l=c[u],this.n.n(l.t.y,!1);Array.clear(this.j);this.j=f;this.B()},T:function(n,t){var r=t.b.a,u,i;if(t.a().PresenceType)Array.add(n,r);else{for(u=n.length,i=0;i<u;i++)if(this.h[n[i].User.UserID].a().PresenceType)break;Array.insert(n,i,r)}},br:function(){var t=this.h,n,i;for(n in t)i={key:n,value:t[n]},i.value.dispose();this.h={};this.U();this.m={};this.k={};Array.clear(this.j);this.B()},bn:function(n,t){this.bw(t.a)},bo:function(){this.l.b()&&this.l.b().a()&&this.l.b().a()!==1||this.g.isChangeGateEnabled("IgnorePresenceServiceConnectionLost")||this.i.a(null)},M:function(n){var u,t,i,r;this.i.b(n.a())&&(this.T(this.j,n),this.B());u=n.b.a.User.UserID;t=this.h;for(i in t)r={key:i,value:t[i]},r.key!==u&&n.x(r.value)},B:function(){this.j.length>0&&this.bv(!0)},bv:function(n){for(var t,o,u,i=0,f=this.j.length;i<f;i++)if(t=this.h[this.j[i].User.UserID],t)if(n)if(this.i.i(t.a())){t.p(!0);for(var e=t.d(),s=e.length,r=0;r<s;++r)o=e[r],this.n.n(o.t.y,!0)}else u=this.i.h(t.a()),u&&t.q(!0,u);else t.p(!1),t.q(!1,null)},bi:function(n){var t={};return t.User={},t.User.UserID=n,t.User.UserName=_Ewa.ClientStringManager.a().c(82),t.UserColor="#AAAAAA",t},V:function(n,t){if(this.Q&&this.w){if(!n||!t){Diag.a.a(42481443,0,15,"userId: [{0}], endTime: [{1}]",n,t);return}if(this.A){this.A.a(n,t,this.p,0);return}var i=this;this.w.CW(function(){i.A=i.w.a();i.V(n,t)})}}};_Ewa.gO=function(n,t){this.F=Function.createDelegate(this,this.Z);this.I=Function.createDelegate(this,this.be);this.J=Function.createDelegate(this,this.bf);this.K=Function.createDelegate(this,this.bg);this.G=Function.createDelegate(this,this.ba);this.C=Function.createDelegate(this,this.V);this.H=Function.createDelegate(this,this.bd);this.E=Function.createDelegate(this,this.Y);this.u=Function.createDelegate(this,this.X);this.D=Function.createDelegate(this,this.W);this.v=Function.createDelegate(this,this.bc);this.z=Function.createDelegate(this,this.bb);this.L=Function.createDelegate(this,this.bh);this.M=Function.createDelegate(this,this.bi);_Ewa.gO.initializeBase(this,[!1]);this.n=n;this.q=_Ewa.b.a(this.n).a();this.x=t;this.n.D(this.M);this.n.G(this.L);this.o={};this.s=new Common.dg;this.r={};this.r.b=0;this.r.c=0;this.A=new _Ewa.gO.e(this.n)};_Ewa.gO.a=function(){return _Ewa.gO.b||(_Ewa.gO.b={ApplyFilter:1,ApplyPivot:0,ApplyPivotSort:0,ApplyPivotSortByValue:1,ApplyWellKnownPivotFilter:0,RemovePivotFilter:0,SetCustomFilter:1,SetTop10Filter:1,TogglePivotDrill:0,RefreshAll:2})};_Ewa.gO.d=function(n,t){return!!n&&!!n.ObjectId&&!!t&&!!t.ObjectId&&(!n.ObjectType||n.ObjectType===2)&&n.ObjectType===t.ObjectType&&!n.ObjectId.localeCompare(t.ObjectId)};_Ewa.gO.c=function(n,t){return!n.NamedObjectName&&_Ewa.fA.a(n,t)};_Ewa.gO.prototype={n:null,x:null,q:null,p:null,s:null,t:null,r:null,A:null,d:function(n){this.dQ("presenceChanged",n)},k:function(n){this.dR("presenceChanged",n)},c:function(n){this.n.c().U(n)},j:function(n){this.n.c().W(n)},f:function(n){this.dQ("selectionChanged",n)},m:function(n){this.dR("selectionChanged",n)},e:function(n){this.dQ("presenceDisabled",n)},l:function(n){this.dR("presenceDisabled",n)},o:null,g:function(){return this.o},Q:function(){return!this.n.c()||this.n.c().H()},dispose:function(){this.n&&(this.P(),this.n.F(this.M),this.n.H(this.L));this.p&&this.p.h(this.z);System.a.a(this.A);this.p=null;this.n=null;_Ewa.ce.prototype.dispose.call(this)},a:function(n){this.p?this.p.h(this.z):this.R();this.p=n;this.p?(this.p.e(this.z),this.y(!0)):this.P()},R:function(){var i,t,r,n;this.n.a(912)?this.q.n(this.v):this.q.e(this.v);_Ewa.b.a(this.n).K(this.D);i=_Ewa.b.a(this.n).h();i.g(this.u);i.c(this.E);this.n.c().g(this.H);this.n.c().bq(this.C);this.x.a(this.G);t=this.n.d().a();t.q(this.K);t.e(this.J);t.d(this.I);r=_Ewa.l.b(_Ewa.eA,this.n.b(),16,74,1,null);n=this;_Ewa.f.cw(r,function(t){n.t=t.a();n.t.J(n.F);n.t.I(n.u)},$$sc.f.a,3)},P:function(){this.n.a(912)?this.q.o(this.v):this.q.f(this.v);_Ewa.b.a(this.n).L(this.D);var n=_Ewa.b.a(this.n).h();n.f(this.u);n.d(this.E);this.n.c().i(this.H);this.n.c().by(this.C);this.x.b(this.G);this.t&&(this.t.O(this.F),this.t.M(this.u),this.n.d().a().t(this.K),this.n.d().a().g(this.J),this.n.d().a().f(this.I));this.dP("presenceDisabled",null,null)},b:function(n){return this.i(n)||!!this.h(n)},i:function(n){var f,e,t,i,o,s,r,u;if(this.o.Version===2&&this.o.Object&&n.Version===2&&n.Object&&this.o.Object.length>0&&n.Object.length>0)for(f=this.o.Object.length,e=n.Object.length,t=0;t<f;t++)for(i=0;i<e;i++)if(this.U(this.o.Object[t],n.Object[i]))return!0;if(this.o.SelectedRange&&n.SelectedRange)for(o=this.o.SelectedRange.length,s=n.SelectedRange.length,r=0;r<o;r++)for(u=0;u<s;u++)if(_Ewa.gO.c(this.o.SelectedRange[r],n.SelectedRange[u]))return!0;return!1},h:function(n){var r,u,t,i;if(this.o.Version===2&&this.o.Object&&n.Version===2&&n.Object&&this.o.Object.length>0&&n.Object.length>0)for(r=this.o.Object.length,u=n.Object.length,t=0;t<r;t++)for(i=0;i<u;i++)if(_Ewa.gO.d(this.o.Object[t],n.Object[i]))return this.o.Object[t].ObjectId;return null},U:function(n,t){return!!n&&!!t&&n.ObjectType===t.ObjectType&&(n.ObjectType===1||n.ObjectType===3)&&!!n.ObjectId&&!!t.ObjectId&&!n.ObjectId.localeCompare(t.ObjectId)},T:function(){this.y(!1)},y:function(n){this.q.b().a()?this.N(0,n):this.O(_Ewa.b.a(this.n).h().h()?1:0,n)},N:function(n,t){var u={},r,i,f;if(this.n.B(u),this.q.b().a()){if(r=this.q.b().a().a(),u.FirstColumn=-1,u.FirstRow=-1,u.LastColumn=-1,u.LastRow=-1,u.NamedObjectName=r?r.h():null,this.o.SelectedRange=[u],this.o.PresenceType=0,i=null,r)switch(r.a){case 0:f=this.n.p().bt(r.b);f&&(i={},i.ObjectType=this.w(0),i.ObjectPresenceType=n,i.ObjectId=f.Q);break;case 2:r.b&&(i={},i.ObjectType=this.w(9),i.ObjectPresenceType=n,i.ObjectId=r.E)}this.o.Object=[i]}this.dP("selectionChanged",null,null);this.B(t)},O:function(n,t){var f,r,s,u,i;if(this.n.isChangeGateEnabled("OfficeVSO:4636852_FixPresenceCheckForRangePicker")?!_Ewa.b.a(this.n).l()&&!_Ewa.b.a(this.n).J():!_Ewa.b.a(this.n).H()){f=this.n.o().b("ModelUpdate","SendRangePresence");f.d();r=_Ewa.g.B(this.q.a().c(),this.n);this.o.SelectedRange=this.n.a(362)?this.x.c(r):r;this.o.Object=[];for(var o=r,h=o.length,e=0;e<h;++e)s=o[e],u=_Ewa.fA.b(s,this.n,1),u&&(i={},i.ObjectType=this.w(u.P),i.ObjectPresenceType=0,i.ObjectId=u.Q,Array.add(this.o.Object,i));this.o.PresenceType=n;this.dP("selectionChanged",null,null);this.o.SelectedRange||this.o.Object?this.B(t):Diag.a.a(41185635,0,50,"SelectionPresenceManager.SendRangePresence: skip sending range presence since selected range/object are both null.  UserId: [{0}]",this.p.b());f.a()}},B:function(n){(this.n.c().br()||!this.n.a(147)||!this.n.c().be()||n)&&(this.Q()||++this.r.b,this.p&&(this.o.Version=2,this.o.ClientType=1,this.o.ChatThreadId=this.s.u,this.o.ChatThreadDiscoveryUri=this.s.t,this.o.InChat=this.s.v,this.o.Cid=this.s.s,this.o.SupportsChat=!!this.s.q&&this.s.q.a(4),this.o.CollabMode=this.n.c().T()?2:0,this.o.OcsCapable=this.n.c().bv(),this.p.q(this.o),this.Q()||++this.r.c))},W:function(){this.n&&this.N(0,!1)},Y:function(){this.o.PresenceType=1;this.dP("selectionChanged",null,null);this.B(!1)},X:function(){this.y(!1);this.S()},Z:function(){this.q.b().a()?this.N(1,!1):this.O(0,!1)},bb:function(n,t){this.dP("presenceChanged",t,null)},bc:function(){this.O(_Ewa.b.a(this.n).l()?1:0,!1)},bd:function(n,t){_Ewa.mk.a(t)&&(this.o={})},ba:function(){this.n.a(362)&&this.T()},bg:function(n,t){var i,e,c,o,h,u,f,r;if(t&&t.c in _Ewa.gO.a()){i=null;e=!1;switch(_Ewa.gO.a()[t.c]){case 0:i=t.b.cell;break;case 1:i=t.b.parameters.Location;break;case 2:c=this.q.a().e();i=_Ewa.g.a(c,this.n);e=!0;break;default:return}if(i.LastColumn=i.FirstColumn,i.LastRow=i.FirstRow,i.NamedObjectName=null,this.o.SelectedRange=[i],this.o.PresenceType=0,e){o=[];for(var l=this.n.p().bZ(1),a=l.length,s=0;s<a;++s)h=l[s],u={},u.ObjectType=this.w(h.P),u.ObjectPresenceType=1,u.ObjectId=h.Q,Array.add(o,u);this.o.Object=o}else f=_Ewa.fA.b(i,this.n,1),r=null,f&&(r={},r.ObjectType=this.w(f.P),r.ObjectPresenceType=0,r.ObjectId=f.Q),this.o.Object=[r];this.dP("selectionChanged",null,null);this.B(!1)}},be:function(n,t){t.a.a in _Ewa.gO.a()&&(this.o.Object=[null],this.y(!1))},bf:function(n,t){t.b.a in _Ewa.gO.a()&&(this.o.Object=[null],this.y(!1))},bi:function(n,t){t.b||(this.o={},this.n.k()?this.R():this.P())},bh:function(){this.S()},S:function(){this.n.k()&&(this.r.a=this.n.f().UserSessionId,_Ewa.B.a().a(26,this.r,!0));this.r.b=0;this.r.c=0},w:function(n){switch(n){case 0:return 0;case 1:return 1;case 2:return 3;case 9:return 2;default:return-1}},V:function(){this.T();this.A.c()}};_Ewa.gO.e=function(n){_Ewa.gO.e.initializeBase(this,[!1]);this.a=n;var t=this;this.a.b().c(_Ewa.bX,29,function(n){t.b=n;n.c(t)},null)};_Ewa.gO.e.prototype={a:null,b:null,m:function(n){this.dQ("OSC",n)},l:function(n){this.dR("OSC",n)},c:function(){this.dP("OSC",null,null)},d:function(n,t){if(n==="QueryOcsConnectionStatus")t.Value=this.a.c().T()?_Ewa.ClientStringManager.a().a(810):_Ewa.ClientStringManager.a().a(811);else return!1;return!0},h:function(){return!0},dispose:function(){this.b&&(this.b.b(this),this.b=null);this.a=null;_Ewa.ce.prototype.dispose.call(this)}};_Ewa.QM=function(n){_Ewa.QM.initializeBase(this);this.f=n;this.e()};_Ewa.QM.prototype={f:null,a:null,p:function(){if(this.a)this.d(this.a);else{var n=this;_Ewa.f.cw(_Ewa.l.a(_Ewa.lV,this.f.b(),28,this.b(),this.c,null),function(t){n.d(n.a||(n.a=new _Ewa.gO(n.f,t.a())))},this.b(),3)}}};_Ewa.QN=function(n,t,i,r,u){this.K=Function.createDelegate(this,this.V);this.G=Function.createDelegate(this,this.U);this.Q=Function.createDelegate(this,this.Y);this.J=Function.createDelegate(this,this.W);this.z=[];_Ewa.QN.initializeBase(this,[!1]);this.y=n;this.w=t;this.N=n.id;this.C=r;this.O=u;this.E=!1;this.S();this.L=i;this.B=null;this.x={};this.x.FirstColumn=0;this.x.FirstRow=0;this.x.LastColumn=0;this.x.LastRow=0};_Ewa.QN.prototype={w:null,y:null,A:null,E:!1,I:!1,x:null,B:null,F:null,O:null,D:null,j:function(n){this.dQ("hidePresenceTooltip",n)},p:function(n){this.dR("hidePresenceTooltip",n)},m:function(n){this.dQ("showPresenceTooltip",n)},r:function(n){this.dR("showPresenceTooltip",n)},l:function(n){this.dQ("showFullPresenceTooltip",n)},q:function(n){this.dR("showFullPresenceTooltip",n)},k:function(n){this.dQ("presenceChanged",n)},s:function(n){this.dR("presenceChanged",n)},N:null,a:function(){return this.N},L:null,c:function(){return this.L},C:0,b:function(){return this.C},h:function(){if(!this.y)return null;var t=this.w.n(this.C).P(),u=this.w.d(),f=this.y.offsetWidth;if(!this.B&&f<=4){if(this.x){var n=this.w.r(),i=this.x.FirstRow,r=u?this.x.FirstColumn:this.x.LastColumn;if(n&&!(i>=n.a&&i<=n.c&&r>=n.b&&r<=n.d))return i=i<=n.a?t.a.b:t.a.b+(i>=n.c?t.d():t.d()/2),r=r<=n.b?t.a.a:t.a.a+(r>=n.d?t.c():t.c()/2),this.F=new Sys.UI.Point(r,i)}return this.F}if(this.B){var s=this.y.offsetTop-2,e=parseInt(this.y.style.left),o=0;return u&&(o=parseInt(this.y.parentNode.style.width)-f-e-(this.w.bf().b()&&this.w.bf().c()?_Ewa.Y.a():0)),this.F=new Sys.UI.Point((u?o:e)+f+4,s)}return this.F=new Sys.UI.Point(parseInt(u?this.y.style.right:this.y.style.left)+f,this.y.offsetTop)},H:!1,g:function(){return this.H},t:function(n){return this.H=n,n},M:null,i:function(){return _Ewa.g.b(this.x)},dispose:function(){this.dP("hidePresenceTooltip",null,null);this.dP("presenceChanged",null,null);this.R();this.P();System.a.a(this.D);this.w=null;this.y=null;this.M=null;_Ewa.ce.prototype.dispose.call(this)},u:function(n,t){var i=!!n&&!_Ewa.g.b(n).f(_Ewa.g.b(this.x)),r=!!t&&(!this.B||this.B.U()!==t.U());(i||r)&&(this.dP("presenceChanged",null,null),this.R(),this.H=!1,this.x=n,this.B=t,this.F=null)},o:function(n){this.H=!1;this.I=!1;n&&this.dP("hidePresenceTooltip",null,null)},n:function(n){Array.add(this.z,n);this.S();n.k(this.J)},e:function(n,t){if(n){if(this.I=!0,t){var i=this.O.f().ShowTooltipDelayInMs;this.D=_Ewa.de.a(this.Q,i,_Ewa.m.cJ,this.D)}}else this.o(t)},f:function(n){this.M=n},v:function(){if(this.y&&this.I){this.A=_Ewa.a.i(this.y);var n=Math.floor(this.A.x);this.A.x=n===this.A.x?n:n+1;this.A.y=Math.floor(this.A.y)}},d:function(){if(!this.x)return!1;var n=this.w.n(this.C).P(),t=this.w.x(this.i(),this.C,!1,!1);return n.i(t)},Y:function(){(System.a.a(this.D),this.D=null,this.I)&&(this.d()?this.dP("showPresenceTooltip",null,null):this.o(!0))},R:function(){for(var n=0,t=this.z.length;n<t;n++)this.z[n].s(this.J);Array.clear(this.z);this.P()},S:function(){!this.E&&this.z.length>=1&&(this.E=!0,this.w.b().j(this.G),this.w.b().d(this.G),this.w.i().d(this.K))},P:function(){this.E&&!this.z.length&&(this.E=!1,this.w&&(this.w.b().l(this.G),this.w.b().c(this.G),this.w.i().b(this.K)))},X:function(n){n.s(this.J);Array.remove(this.z,n);this.P()},W:function(n){var t=n;this.X(t)},U:function(){this.T()},V:function(){this.T()},T:function(){this.v();for(var n=0,t=this.z.length;n<t;n++)this.z[n].v()}};_Ewa.oh=function(n,t,i){this.r=Function.createDelegate(this,this.J);this.s=Function.createDelegate(this,this.K);this.e=new _Ewa.v(!0);_Ewa.oh.initializeBase(this);this.b=new _Ewa.yA(n);this.y(n);this.f=i;this.n([]);this.c=t;this.c.e().d(this.s);_Ewa.b.a(this.c).X(this.r)};_Ewa.oh.a=function(n,t,i,r,u,f){var e=n===1?32:31;r&&i&&r.a()===i.SheetName?(t.val.a(_Ewa.g.b(i),[e],!0),t.val.bI(e),Diag.a.b(41754975,0,t.val.t.y===u.User.UserID,"UserID and UnitID should match"),f.M(t.val.t.y,n===1)):t.val.bF(e)};_Ewa.oh.prototype={c:null,f:null,i:0,j:0,t:0,a:function(){return this.b.d()},o:function(n){return this.b.e(n),this.w(),n},dispose:function(){this.c&&(this.c.e()&&this.c.e().e(this.s),_Ewa.b.a(this.c).V(this.r));this.A();System.a.b(this.d());System.a.b([this.b]);this.c=null;this.b=null;this.n(null);this.e=null;_Ewa.baX.prototype.dispose.call(this)},A:function(){if(this.e){for(var n=0;n<this.e.a.length;n++)this.e.a[n].dispose();this.e.f()}},x:function(n){this.a().Version===1?this.E(n):this.F(n)},E:function(n){var r,u,t,i;if(n.a().SelectedRange&&this.a().SelectedRange)for(r=this.a().SelectedRange.length,u=n.a().SelectedRange.length,t=0;t<r;t++)for(i=0;i<u;i++)if(_Ewa.fA.a(this.a().SelectedRange[t],n.a().SelectedRange[i])){this.d()[t].V(n.h(i));return}},F:function(n){var e=0,o=0,p,s,t,i,h,c,r,l,a,w,b,u,f,v,y;if(this.a()&&this.a().Object&&n.a()&&n.a().Object)for(p=this.a().Object.length,s=n.a().Object.length,t=0;t<p;t++)if(this.a().Object[t]&&this.v(this.a().Object[t])){for(e++,i=0;i<s;i++)if(n.a().Object[i]&&this.v(n.a().Object[i])&&(o++,this.D(this.a().Object[t],n.a().Object[i])&&(h=this.h(e),c=n.h(o),h&&c))){h.V(c);return}}else if(this.a().Object[t]&&n.a().Object[t]&&(!this.a().Object[t].ObjectType||this.a().Object[t].ObjectType===2))for(r=0;r<s;r++)if(n.a().Object[r]&&(!n.a().Object[t].ObjectType||n.a().Object[t].ObjectType===2)&&this.a().Object[t].ObjectId===n.a().Object[r].ObjectId&&(l=this.m(this.a().Object[t].ObjectId),a=n.m(this.a().Object[t].ObjectId),l&&a)){l.k(a);return}if(n.a().SelectedRange&&this.a().SelectedRange)for(w=this.a().SelectedRange.length,b=n.a().SelectedRange.length,u=0;u<w;u++)for(f=0;f<b;f++)if(_Ewa.fA.a(this.a().SelectedRange[u],n.a().SelectedRange[f])&&(v=this.h(e+u),y=n.h(o+f),v&&y)){v.V(y);return}},D:function(n,t){return!!n&&!!t&&t.ObjectType===n.ObjectType&&(n.ObjectType===1||n.ObjectType===3)&&!n.ObjectId.localeCompare(t.ObjectId)},h:function(n){return n>=0&&this.d().length>n?this.d()[n]:null},p:function(n){for(var t=0,i=this.d().length;t<i;t++)this.d()[t].bl(n)},m:function(n){return n&&this.e.e(n)?this.e.b[n]||null:null},q:function(n,t){var r,i,u;if(n)r=this.e.b[t]||null,r&&r.j(!0);else for(i=0;i<this.e.a.length;i++)u=this.e.a[i],u&&u.j(!1)},z:function(n){_Ewa.rg.a(this,n)},u:function(n,t){if(n<t)return this.d()[n];if(!this.g()||!this.c||!this.f)return null;var i=new _Ewa.fB(this.g(),this.c,this.f);return Array.add(this.d(),i),i},L:function(){for(var t,f,e,i,r=this.d().length,u=this.a().SelectedRange?this.a().SelectedRange.length:0,o=this.c.e().a(),n=0;n<u;n++)(t=this.u(n,r),t&&this.a().SelectedRange[n])&&(this.a().SelectedRange[n].NamedObjectName?t.b([32,31]):(t.X(this.a().SelectedRange[n],this.a().PresenceType),_Ewa.oh.a(this.a().PresenceType,f={val:t},this.a().SelectedRange[n],o,this.g(),this.f),t=f.val));for(e=!!this.b&&!!this.b.b&&this.b.b.PresenceType!==this.b.d().PresenceType,i=e?0:u;i<r;i++)this.d()[i].b([this.b.b.PresenceType===1?32:31])},v:function(n){if(n&&n.ObjectId&&(this.B(n.ObjectType)===1||this.B(n.ObjectType)===2)){var t=this.c.p().bn(n.ObjectId);if(t)return _Ewa.g.O(t)}return null},M:function(){for(var u,f,n,e,o,l,i,t,a,v,s,y,h=this.d().length,r=this.c.e().a(),p=this.a().SelectedRange?this.a().SelectedRange.length:0,w=this.a().Object?this.a().Object.length:0,c=0;c<h;c++)this.d()[c].b([32,31]);for(this.G(),u=0,this.i=0,this.j=0,f=0;f<w;f++)n=this.a().Object[f],e=this.v(n),e&&(o=this.u(u,h),n.ObjectType===1?this.i++:n.ObjectType===3&&this.j++,u++,o.X(e,n.ObjectPresenceType),_Ewa.oh.a(n.ObjectPresenceType,l={val:o},e,r,this.g(),this.f),o=l.val);for(i=0;i<p;i++)if(this.a()&&this.a().SelectedRange&&(t=this.a().SelectedRange[i],!t.NamedObjectName)){if(a=!!r&&t.SheetName===r.a(),v=!!_Ewa.fA.b(t,this.c,1),a&&v)continue;s=this.u(u+i,h);s.X(t,this.a().PresenceType);_Ewa.oh.a(this.a().PresenceType,y={val:s},t,r,this.g(),this.f);s=y.val}(this.t=this.C())>0&&Diag.a.a(25190625,0,50,'{{"SetAllFloatingObjectPresenceHighlights":"Success"}')},G:function(){this.C();this.A()},C:function(){var t=0,n,i;if(this.a()&&this.a().Object)for(n=0;n<this.a().Object.length;n++)i=this.a().Object[n],this.N(i)&&t++;return t},H:function(n,t){var r,i;return this.e.e(t)?(r=this.e.b[t]||null,r.a(n),r):!this.g()||!this.c||!this.f?null:(i=new _Ewa.QH(this.g(),this.c,this.f),i.a(n),this.e.c(t,i),i)},N:function(n){var r=!1,t,i;if(n&&n.ObjectId&&(!n.ObjectType||n.ObjectType===2))try{t=this.I(n);t&&(i=this.H(t,n.ObjectId),i.c(t,n.ObjectPresenceType),i.b(),r=!0)}catch(u){Diag.a.a(25190626,0,10,'{{"UpdatedFloatingObjectPresence":"Fail","Exception":"{0}"}',u.stack);throw u;}return r},I:function(n){var t,r,i;return n?(t=null,n.ObjectType===2?t=_Ewa.L.a(this.c).o(n.ObjectId):n.ObjectType||(r=this.c.p(),i=r.bn(n.ObjectId),i&&i.S&&(t=_Ewa.L.a(this.c).J(i.S))),t):null},w:function(){try{this.a().Version===1?(this.L(),Diag.a.a(25031579,0,50,'{{"SetGridHighlightPass":"V1"}')):(this.M(),Diag.a.a(25031580,0,50,'{{"FloatingObjects":"{0}","PivotTables":"{1}","QueryTables":"{2}"}',this.t,this.i,this.j))}catch(n){Diag.a.a(25031581,0,10,'{{"SetGridHighlight Exception":"{0}"}',n.stack);throw n;}},J:function(){this.w()},K:function(){this.w()},B:function(n){switch(n){case 0:return 0;case 1:return 1;case 3:return 2;case 2:return 9;default:return-1}}};_Ewa.yA=function(n){_Ewa.yA.initializeBase(this,[!1]);this.a=n;this.c=null;this.b=null};_Ewa.yA.prototype={c:null,a:null,d:function(){return this.c||{}},e:function(n){return this.b=this.c,this.c=n,this.dP("userPresenceChanged",null,null),n},b:null,dispose:function(){this.dP("userPresenceChanged",null,null);this.dP("userLeft",null,null);this.a=null;this.c=null;this.b=null;_Ewa.ce.prototype.dispose.call(this)}};_Ewa.bgy=function(){};_Ewa.bgy.b=function(){_Ewa.k.a(function(n){var t=n.b(),i,r;t.b(_Ewa.wZ.$$(_Ewa.lV),28,new _Ewa.QI(n));t.b(_Ewa.wZ.$$(_Ewa.of),158,new _Ewa.QM(n));_Ewa.k.a(_Ewa.ri.a);i=_Ewa.l.a(_Ewa.of,n.b(),158,t.d(),1,null);r=_Ewa.l.a(_Ewa.lV,n.b(),28,t.d(),1,null);_Ewa.f.cw(_Ewa.f.ws([i,r],t.d(),3),function(){var f=new($$sc.D.$$(Common.fx)),e=t.a(_Ewa.jr,26,!1,null),u;e.i(f.h);u=new _Ewa.og(n,e,i.a(),r.a(),Common.Utils.b.a(Common.App.CoauthTelemetry.b,Common.Utils.a.a().c(Common.App.CoauthTelemetry.b,null)));_Ewa.eP.a(n.b()).a(u);t.b(_Ewa.wZ.$$(Common.eB),159,new _Ewa.ri);_Ewa.f.c(_Ewa.l.a(Common.eB,t,159,t.d(),1,null),function(t){var r=new($$sc.D.$$(Common.ha)),i,e;r.b(u);e=new Common.App.Presence.a((i=new Common.dg,i.n=n.l().ClientId,i),f.a,r.a,t.a(),Common.T.a(),Common.a.a.a("AwayStatusOneMinuteTimeoutIsEnabled")?6e4:Common.a.a.c("AwayCoauthorThresholdMs",9e5),Common.a.c().s,_Ewa.bgy.a.b(),!1)},t.d())},t.d(),3);Common.Utils.a.a().b(_Ewa.yw,null).c(Common.dd,null).a().b(function(){return new _Ewa.yw(n)});Common.Utils.a.a().a(Common.dd,null);Common.Utils.a.a().b(_Ewa.yy,null).c(Common.ck,null).a().b(function(){return new _Ewa.yy(n)});Common.Utils.a.a().a(Common.ck,null)})};_Ewa.bgy.a=function(){};_Ewa.bgy.a.b=function(){return _Ewa.bgy.a.a||(_Ewa.bgy.a.a=new _Ewa.bgy.a),_Ewa.bgy.a.a};_Ewa.bgy.a.prototype={a:function(){Diag.a.a(38339419,0,50,"PresenceBootstrapper.AddNotificationBarEntry: User state changed from inactive to active")},b:function(n,t){return new CommonUI.o(n,t)},dispose:function(){}};_Ewa.QL=function(){};_Ewa.QL.a=function(n,t,i,r,u){var f=n.a(1,u);return _Ewa.j.a(n,"GetNamedSheetViewConversion",f,t,i,r,132,null)};_Ewa.fA=function(){};_Ewa.fA.c=function(n){var t={};return t.SheetName=n.SheetName,t.FirstColumn=n.FirstColumn,t.FirstRow=n.FirstRow,t.LastRow=n.LastRow,t.LastColumn=n.LastColumn,t.NamedObjectName=n.NamedObjectName,t};_Ewa.fA.a=function(n,t){return!!n&&!!t&&n.SheetName===t.SheetName&&(!!n.NamedObjectName&&n.NamedObjectName===t.NamedObjectName||!n.NamedObjectName&&!t.NamedObjectName&&_Ewa.g.b(n).i(_Ewa.g.b(t)))};_Ewa.fA.b=function(n,t,i){var u,r;if(!t||!t.p())return null;for(u=0;u<t.p().c();u++)if(r=t.p().g(u),r&&r.P===i&&r.N&&r.N.h(_Ewa.g.b(n))&&_Ewa.e.b(r.O,n.SheetName,!0))return r;return null};_Ewa.yx=function(){};_Ewa.yx.a=function(n,t,i){if(!t)return null;var r=n.v();return new Sys.UI.Point(t.x+r.a*(i?1:-1),t.y+r.b*(i?1:-1))};_Ewa.Po.registerClass("_Ewa.Po",_Ewa.ce,_Ewa.lV,Sys.IDisposable);_Ewa.yw.registerClass("_Ewa.yw",null,Common.dd);_Ewa.QH.registerClass("_Ewa.QH",null,_Ewa.bgw,Sys.IDisposable);_Ewa.rg.registerClass("_Ewa.rg",_Ewa.baX);_Ewa.QI.registerClass("_Ewa.QI",_Ewa.rw.$$(_Ewa.lV));_Ewa.fW.registerClass("_Ewa.fW",_Ewa.ce,Common.App.CollabControls.l,Sys.IDisposable);_Ewa.rh.registerClass("_Ewa.rh",_Ewa.ce,_Ewa.bgx,Sys.IDisposable);_Ewa.yy.registerClass("_Ewa.yy",null,Common.ck,Sys.IDisposable);_Ewa.ri.registerClass("_Ewa.ri",_Ewa.rw.$$(Common.eB));_Ewa.fB.registerClass("_Ewa.fB",_Ewa.gF);_Ewa.yz.registerClass("_Ewa.yz",null,Sys.IDisposable);_Ewa.og.registerClass("_Ewa.og",_Ewa.ce,_Ewa.nQ,Common.ha);_Ewa.gO.registerClass("_Ewa.gO",_Ewa.ce,_Ewa.of,Sys.IDisposable);_Ewa.gO.e.registerClass("_Ewa.gO.e",_Ewa.ce,Sys.IDisposable,_Ewa.wB,Common.IRootUser);_Ewa.QM.registerClass("_Ewa.QM",_Ewa.rw.$$(_Ewa.of));_Ewa.QN.registerClass("_Ewa.QN",_Ewa.ce,_Ewa.bgx,Sys.IDisposable);_Ewa.oh.registerClass("_Ewa.oh",_Ewa.rg);_Ewa.yA.registerClass("_Ewa.yA",_Ewa.ce);_Ewa.fW.b=null;_Ewa.fB.c=[31,32];_Ewa.fB.a=null;_Ewa.gO.b=null;_Ewa.bgy.a.a=null;_Ewa.bgy.b();Type.registerNamespace("_Ewa");_Ewa.rj=function(n,t,i){this.g=Function.createDelegate(this,this.i);_Ewa.rj.initializeBase(this,[!1]);this.e=t;this.h=n;this.d=i;this.b=[];i.d(this.g);this.e.b().b(_Ewa.oi,231,this)};_Ewa.rj.a=function(n,t){var i,r,u,f;return!n.length&&!t.length?"":t.length?t.length===1?(i=_Ewa.ClientStringManager.a().c(78),String.format(i,t[0].UserName)):(r=_Ewa.ClientStringManager.a().c(79),String.format(r,t.length)):n.length===1?(u=_Ewa.ClientStringManager.a().c(80),String.format(u,n[0].UserName)):(f=_Ewa.ClientStringManager.a().c(81),String.format(f,n.length))};_Ewa.rj.prototype={e:null,h:null,d:null,b:null,f:null,c:null,a:function(n,t){var i,r,u,f;return this.b=[],this.d.e(n,t,u={val:i},f={val:r}),i=u.val,r=f.val,Array.addRange(this.b,i),Array.addRange(this.b,r),_Ewa.rj.a(i,r)},dispose:function(){this.d.f(this.g);this.c&&(System.a.a(this.c),this.c=null);_Ewa.baX.prototype.dispose.call(this)},i:function(n,t){var s,h,l,a,f,y,p;if(t.b){var i=[],r=[],u=_Ewa.b.a(this.e).a(),e=!(u.c()===2||u.c()===128),o;o=e?_Ewa.g.B(u.a().c(),this.e):u.b().a().a();s=t.b;for(h in s)l={key:h,value:s[h]},a=l.key,this.d.b(o,e,i,r,a);for(var v=this.b,w=v.length,c=0;c<w;++c)f=v[c],Array.contains(i,f)||Array.contains(r,f)||this.d.b(o,e,i,r,f.UserID);this.b=[];Array.addRange(this.b,i);Array.addRange(this.b,r);this.f&&(System.a.a(this.c),this.c=null,this.f=null);y=_Ewa.rj.a(i,r);this.c=new _Ewa.fP;p=this;this.f=_Ewa.f.cw($$sc.a.b(1),function(){p.h.d(y,"polite")},this.c.a(),3)}}};_Ewa.rj.registerClass("_Ewa.rj",_Ewa.baX,_Ewa.oi);Type.registerNamespace("_Ewa");_Ewa.QO=function(){};_Ewa.QO.b=function(){_Ewa.k.a(_Ewa.QO.a)};_Ewa.QO.a=function(n){var t=n.b(),i=_Ewa.l.b(_Ewa.cC,n.b(),211,212,1,null);t.c(_Ewa.nQ,25,function(r){_Ewa.f.cw(i,function(i){var u=t.a(_Ewa.oi,231,!1,null)||new _Ewa.rj(i.a(),n,r)},t.d(),3)},null)};_Ewa.QO.b();Type.registerNamespace("_Ewa");_Ewa.yG=function(n){this.p=Function.createDelegate(this,this.t);this.n=Function.createDelegate(this,this.v);_Ewa.yG.initializeBase(this,[!1]);this.m=n;this.m.G(this.n);this.m.c().cp(this.n);var t=this;n.b().c(Common.hd,38,function(n){n.g(t.n)},null)};_Ewa.yG.a=function(n){n.b().b(_Ewa.jr,26,new _Ewa.yG(n))};_Ewa.yG.prototype={m:null,o:null,r:null,c:function(n){this.dQ("connectionCompleted",n)},e:function(n){this.dR("connectionCompleted",n)},j:function(n){this.dQ("rtcInitialized",n)},g:function(n){this.dR("rtcInitialized",n)},d:function(n){this.dQ("connectionLostEventKey",n)},f:function(n){this.dR("connectionLostEventKey",n)},l:null,b:function(){return this.l},q:!1,k:function(){return this.q},dispose:function(){this.l&&this.l.g(this.p);this.m&&this.m.H(this.n);this.m=null;this.l=null;_Ewa.ce.prototype.dispose.call(this)},i:function(n){var t=this;_Ewa.f.c(this.s().a,function(t){n(t.a())},this.dS())},h:function(n,t){this.q=t;this.u(n)},a:function(){this.l&&(this.dP("rtcInitialized",null,null),this.l.a()===2&&this.o&&this.dP("connectionCompleted",new _Ewa.uh(this.l),this.o))},u:function(n){Diag.a.a(9245249,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice");var i=this,t=this;_Ewa.f.cw(_Ewa.f.ts(_Ewa.t.c(39,4,1,!1,!1,0),function(){return _Ewa.t.c(10,0,1,!1,!1,0)},this.dS(),3,$$sc.c.a),function(){t.l=AppRealtimeChannel.q.c(n,t.m.f().UserSessionId,Common.a.el,Common.a.d,null,2,_Ewa.B.a().l(),t.m.l().RtcEndpointUrl,null,new AppRealtimeChannel.f,null,null);t.s().b(t.l);t.dP("rtcInitialized",null,null);Diag.a.a(9245250,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice raise RealTimeChannelInitializedEventKey");var i=$$as(AppRealtimeChannel.d,t.l);i&&(Diag.a.a(9245251,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice attach changed handler"),i.n(t.p),i.j())},this.dS(),3)},t:function(n,t){t.a===2?(this.l?this.dP("connectionCompleted",new _Ewa.uh(this.l),t):Diag.a.a(38396034,0,15,"RealTimeChannelController.OnConnectionStateChanged: new state is connected and this.RealTimeChannel is null"),this.o=t):t.b!==2&&t.a||(this.o=null,this.dP("connectionLostEventKey",null,null))},v:function(){if(this.l){var n=$$as(AppRealtimeChannel.d,this.l);n&&(Diag.a.a(36573253,0,50,"RealTimeChannelController.OnWorkbookClosed: disconnecting from RTC"),n.k(),n.g(this.p))}this.l=null},s:function(){return this.r||(this.r=new($$sc.D.$$(Common.fx)))}};_Ewa.yG.registerClass("_Ewa.yG",_Ewa.ce,_Ewa.jr,_Ewa.bel);Type.registerNamespace("_Ewa");_Ewa.bgM=function(){};_Ewa.bgM.a=function(){_Ewa.k.a(_Ewa.yG.a)};_Ewa.bgM.a();Type.registerNamespace("_Ewa");_Ewa.Qq=function(n,t,i,r){this.v=Function.createDelegate(this,this.C);this.t=Function.createDelegate(this,this.A);this.u=Function.createDelegate(this,this.B);_Ewa.Qq.initializeBase(this,[n,null]);var u="<div id='notificationBody'>\r\n<div class='clip16x16' id='notificationUserImage'><img class='{0}' src='{1}' id='singleUserImage'/><img class='{2}' src='{3}' id='multiUserImage'/><\/div>\r\n<span class='ewa-new-user-notification-text' id='notificationText'><\/span>\r\n<div class='clip16x16' id='notificationImage'><img class='{4}' src='{5}' alt='{6}' title='{6}' /><\/div>\r\n<\/div>\r\n";this.d=i;this.h=t;this.o=this.h.isChangeGateEnabled("OfficeVSO:3862029_NarratorAnnounceEntry");u=String.format(u,"ewaboot_presenceheads",_Ewa.t.a(3),"ewaother_PlaceContacts_16x16x32",_Ewa.t.a(3),"ewaother_ClosePaneGlyph_16x16x32",_Ewa.t.a(3),this.d.a(712));this.cp().innerHTML=u;this.e=_Ewa.a.a(n,"notificationBody");this.b=_Ewa.a.a(n,"notificationText");this.f=_Ewa.a.a(n,"notificationImage");this.c=_Ewa.a.a(n,"notificationUserImage");this.m=_Ewa.a.a(n,"singleUserImage");this.k=_Ewa.a.a(n,"multiUserImage");_Ewa.a.j(this.b,"alert",null,null,null);this.cv().a("click",this.u,!1);this.j=this.cy.a(this.f);this.j.a("click",this.t,!1);this.q=r};_Ewa.Qq.prototype={e:null,b:null,f:null,c:null,m:null,k:null,j:null,n:null,r:null,s:null,a:null,g:!1,h:null,l:null,q:null,d:null,y:!1,o:!1,dispose:function(){System.a.b([this.j,this.l]);this.e=this.b=this.f=null;this.c=null;_Ewa.oY.prototype.dispose.call(this)},i:function(n){n?this.set_visible(!0):(this.set_visible(!1),this.z())},D:function(n){this.cp().className=n?"ewa-popup-rtl ewa-new-user-notification":"ewa-popup-ltr ewa-new-user-notification";this.cp().dir=n?"rtl":"ltr";n?(this.e.insertBefore(this.b,this.c),this.e.insertBefore(this.f,this.b),this.c.style.marginLeft="10px"):(this.e.insertBefore(this.c,this.b),this.e.insertBefore(this.b,this.f),this.c.style.marginRight="10px")},p:function(n,t){var i;if(n&&n.length){var e=!this.n,r=new($$sc.v.$$(Boolean)),u=new($$sc.v.$$(Boolean)),f=new($$sc.v.$$(Boolean));for(i=0;i<n.length;i++)e?this.w(n[i].User.UserID):this.n.c(n[i].User.UserID)||(this.w(n[i].User.UserID),this.F(n[i],t)&&this.E(n[i])),r.b(n[i].User.UserID,!0),n[i].UserEmail&&u.b(n[i].UserEmail,!0),n[i].User.UserName&&f.b(n[i].User.UserName,!0);this.n=r;this.r=u;this.s=f}},F:function(n,t){return t?(Diag.a.a(37261332,0,50,"NewUserNotificationDialog.ShouldNotifyNewUser - UserEmailAvailable: [{0}], UserNameAvailable: [{1}]",!!n.UserEmail,!!n.User.UserName),n.User.UserName&&this.s.c(n.User.UserName))?(Diag.a.a(37261333,0,50,"NewUserNotificationDialog.ShouldNotifyNewUser - Notified: [false], Reason: [UserNameKnown]"),!1):n.UserEmail&&this.r.c(n.UserEmail)?(n.UserEmail.length||Diag.a.a(37261334,0,50,"NewUserNotificationDialog.ShouldNotifyNewUser - UserEmail is empty"),Diag.a.a(37261335,0,50,"NewUserNotificationDialog.ShouldNotifyNewUser - Notified: [false], Reason: [UserEmailKnown]"),!1):(Diag.a.a(37261336,0,50,"NewUserNotificationDialog.ShouldNotifyNewUser - Notified: [true], Reason: [UserEmailAndNameNotKnown]"),!0):(Diag.a.a(37261331,0,50,"NewUserNotificationDialog.ShouldNotifyNewUser - Notified: [true], Reason: [DedupDisabled]"),!0)},w:function(n){var t={};t.a=this.q;t.b=n;t.c="JoiningUser";t.d=_Ewa.u.a().a();_Ewa.B.a().a(23,t,!0)},E:function(n){if(this.a){var t=!_Ewa.e.e(this.a.User.UserID,n.User.UserID,!1);t||this.g||(this.g=!0,this.x())}else this.a=n,this.x()},x:function(){var n="",t;if(!this.y){this.g?n=this.d.a(711):this.a&&(n=String.format(this.d.c(6),this.a.User.UserName));n!==""&&this.o&&(t=this,_Ewa.f.cw(_Ewa.l.b(_Ewa.cC,this.h.b(),211,212,0,null),function(t){var i=t.a();i.b(!0);i.a(n)},this.h.i(),3));return}this.g?(n=this.d.a(711),this.c.style.backgroundColor="",_Ewa.a.b(this.m,!1,!0),_Ewa.a.b(this.k,!0,!0)):this.a&&(n=String.format(this.d.c(6),this.a.User.UserName),this.c.style.backgroundColor=this.a.UserColor,_Ewa.a.b(this.m,!0,!0),_Ewa.a.b(this.k,!1,!0));this.b.innerText=n;System.a.a(this.l);this.l=_Ewa.x.a().a(this.v,5e3,_Ewa.m.ck,!0,!1);this.i(!0)},z:function(){this.a=null;this.g=!1},C:function(){this.i(!1)},B:function(n){this.i(!1);_Ewa.D.a(n,!0)},A:function(n){this.i(!1);_Ewa.D.a(n,!0)}};_Ewa.jm=function(n,t,i,r,u,f,e,o){var c,s,l,h;if(this.r=Function.createDelegate(this,this.R),this.q=Function.createDelegate(this,this.Q),_Ewa.jm.initializeBase(this,[n,f,e,o]),this.b=t,this.t=i,this.s=r,this.u=u,this.b.c().U(this.q),this.b.G(this.r),c=document.createElement("div"),_Ewa.b.a(this.b).z().appendChild(c),this.e=new _Ewa.Qq(c,this.b,u,this.b.f().UserSessionId),this.e.i(!1),this.e.D(this.b.u()),s=this.b.c().x(),this.t.k())for(l=s.length,h=0;h<l;h++)if(s[h].User.UserID===t.l().ClientId){this.e.p([s[h]],this.x());break}this.e.p(s,this.x());this.v=this.b.isChangeGateEnabled("OfficeVSO:3552310_NoRefreshOnDisposedPeopleWell")};_Ewa.jm.a=function(n){var i=null,t;return n&&(t=n.SelectedRange,i=t&&t.length>0?t[0]:null),i};_Ewa.jm.prototype={e:null,x:function(){return this.b.a(255)},s:null,t:null,u:null,b:null,w:!1,v:!0,dispose:function(){var n=this.b;n&&(n.c().W(this.q),n.H(this.r),this.d.c([]),this.y(),n.h().u(46),_Ewa.rf.a(n));RealtimePresenceUI.b.prototype.dispose.call(this);this.w=!0},K:function(n){return this.bi(n)},L:function(n){return this.bn(n)},J:function(n){return this.bh(n)},F:function(){return this.g?this.g.a():[]},I:function(){},H:function(n,t){var i=_Ewa.jm.a(t),r,u;i&&(r=i.SheetName,r&&(u=_Ewa.g.b(i),this.b.e().p(this.b.e().b(r)),_Ewa.b.a(this.b).I(u,3,_Ewa.E.w,!1,null)))},B:function(n,t){var i=_Ewa.jm.a(t);return!!i&&!i.NamedObjectName},D:function(n,t,i){var o=i,f=_Ewa.jm.a(o),u,l,g,e,a,v,y,tt;if(!f)return"";var r="",p=f.SheetName,h=$$as(_Ewa.M,this.b.j()),w=!h||p!==h.M;w&&(r=String.format("{0}",p));var b="!",k=w?b.toString():"",s=!1;try{if(!(o.Version===1)&&o.Object){for(var d=o.Object,it=d.length,c=0;c<it;++c)if(u=d[c],l=this.P(u),this.N(u)||this.M(u)||l){if(g=this.b.p(),e=g.bn(u.ObjectId),e){r=h&&h.M!==e.O?String.format("{0}{1}",e.O,b):"";r+=l?e.N.toString():e.M;s=!0;break}}else if(this.O(u)&&(a=_Ewa.L.a(this.b).o(u.ObjectId),a)){r=a.a().l;s=!0;break}Diag.a.a(25031572,0,50,"PresenceObject")}!s&&f.NamedObjectName&&o.Version===1&&(v=_Ewa.L.a(this.b).a(f.NamedObjectName,null),v&&(r+=k+v.a().l,s=!0));s||f.NamedObjectName||(y=_Ewa.g.b(f),y.z()&&(r+=k+y))}catch(nt){Diag.a.a(25031575,0,10,'{{"ConvertUserPresenceToStatusString Exception":"{0}"}',nt.stack);throw nt;}return tt=this.u.a(1173),String.format("{0} {1}",tt,r)},y:function(){if(this.v&&this.w){Diag.a.a(50665499,0,50,"EwaPeoplesWellControl.RefreshControlViewImpl: skipping since instance is already disposed.");return}if(_Ewa.o.a()){var n=_Ewa.ch.a(this.b);n&&n.a()&&n.a().m()}else this.s.j(this.c.a.f,!0)},Q:function(){var n,r;Diag.a.a(23643289,0,50,"EwaPeoplesWellControl::OnUserListUpdated");this.j();this.e.p(this.b.c().x(),this.x());n="";for(var i=this.b.c().x(),u=i.length,t=0;t<u;++t)r=i[t],n+=r.User.UserID+";";_Ewa.e.d(n)||Diag.a.a(25049093,0,50,"EwaPeoplesWellControl.OnUserListUpdated: UserList updated [{0}].",n)},R:function(){this.b.b().e(Sys.IDisposable,45,null)},N:function(n){return!!n&&!!n.ObjectId&&n.ObjectType===this.n(1)},M:function(n){return!!n&&!!n.ObjectId&&n.ObjectType===this.n(0)},P:function(n){return!!n&&!!n.ObjectId&&n.ObjectType===this.n(2)},O:function(n){return!!n&&!!n.ObjectId&&n.ObjectType===this.n(9)},n:function(n){switch(n){case 0:return 0;case 1:return 1;case 2:return 3;case 9:return 2;default:return-1}}};_Ewa.Qp=function(n,t){this.b=n;this.a=t};_Ewa.Qp.prototype={b:null,a:null,z:function(){return!1},x:function(n,t,i){var u=this.a.c,f=null,r=t.a,e;return Diag.a.a(23643291,0,50,"EwaPeoplesWellControlHandler::ExecuteCommand: {0}",r),r===u.a.b?(e=this,f=_Ewa.f.c($$sc.a.b(0),function(){e.a.bk()},this.b.i())):r===u.a.d?this.a.K(i):r===u.a.c?this.y(n,"PopulatePeoplesWellControl",i):r===u.a.e?this.a.L(i):r===u.a.g?this.a.j():f=_Ewa.T.a(r),f||$$sc.a.a(Boolean,!0)},w:function(n,t,i){var r=this.a.c,f=!1,u=t.a;return u===r.a.b||u===r.a.g?f=!0:(u===r.a.d||u===r.a.c||u===r.a.e)&&(f=!!i),f},y:function(n,t,i){return t==="PopulatePeoplesWellControl"?(this.a.J(i),!0):!1},dispose:function(){this.b&&this.b.h()&&this.b.h().e(this);this.b=null}};_Ewa.rf=function(n){this.q=Function.createDelegate(this,this.z);this.l=Function.createDelegate(this,this.y);_Ewa.rf.initializeBase(this,[n])};_Ewa.rf.a=function(n){_Ewa.bb.a(46,new _Ewa.rf(n))};_Ewa.rf.prototype={m:!1,k:null,i:null,dispose:function(){this.i&&this.i.g(this.l);this.m=!1;this.k=null;this.i=null;var n=this.a;n&&n.F(this.q);_Ewa.bb.prototype.dispose.call(this)},g:function(){Diag.a.a(23643293,0,50,"PeoplesWellCommandHandlerFactory::CreateCommandHandlersAsync. SessionAction: {0}, EditMode {1}",this.a.c().a(),this.a.k());this.a.c().a()&&this.a.k()?this.u():this.a.D(this.q)},z:function(n,t){t.a||this.u()},y:function(){var t;Diag.a.a(38410441,0,50,"PeoplesWellCommandHandlerFactory::OnRealTimeChannelInitialized");this.i.g(this.l);var r=this.k.p(_Ewa.t.a(3),"ewaboot_presenceheads",_Ewa.t.a(3),"ewaboot_presenceheads32",_Ewa.t.a(3),"ewaboot_presenceheadswhite"),i=$$as(AppRealtimeChannel.d,this.i.b()),n=this;Common.Utils.a.a().b(_Ewa.jm,null).c(Common.dX,null).a().b(function(){var t=i,u=i;return new _Ewa.jm(RealtimePresenceUI.a.a(r,n.a.l().ClientId,t.c||(t.c=Function.createDelegate(t,t.l)),u.d||(u.d=Function.createDelegate(u,u.m)),n.a.a(255)),n.a,n.i,n.k,_Ewa.ClientStringManager.a(),Common.Utils.a.a().a(Common.App.People.b,null),Common.Utils.b.a(Common.ck,Common.Utils.a.a().c(Common.ck,null)),Common.Utils.b.a(Common.App.SkypeChat.a,Common.Utils.a.a().c(Common.App.SkypeChat.a,null)))});t=Common.Utils.a.a().a(Common.dX,null);this.a.b().b(Sys.IDisposable,45,t);this.f([new _Ewa.Qp(this.a,t)],null)},u:function(){Diag.a.a(23643294,0,50,"PeoplesWellCommandHandlerFactory::InitPeoplesWellControl");var t=this.a.b(),n=this;t.c(_Ewa.jr,26,function(i){t.c(_Ewa.bX,53,function(r){_Ewa.f.cw(_Ewa.l.a(Object,t,155,n.b(),n.c,null),function(){n.i=i;n.k=r;n.x()},n.b(),3)},null)},null)},x:function(){this.m||(Diag.a.a(50469021,0,50,"PeoplesWellCommandHandlerFactory::CreatePeoplesWellControl - attach RealTimeChannelInitialized handler"),this.i.j(this.l),this.m=!0);Diag.a.a(50469022,0,50,"PeoplesWellCommandHandlerFactory::CreatePeoplesWellControl - check connection");this.i.a()}};_Ewa.Qq.registerClass("_Ewa.Qq",_Ewa.oY);_Ewa.jm.registerClass("_Ewa.jm",RealtimePresenceUI.b);_Ewa.Qp.registerClass("_Ewa.Qp",null,_Ewa.kx,Sys.IDisposable);_Ewa.rf.registerClass("_Ewa.rf",_Ewa.bb);Type.registerNamespace("_Ewa");_Ewa.bgf=function(){};_Ewa.bgf.a=function(){_Ewa.k.a(_Ewa.rf.a)};_Ewa.bgf.a();Type.registerNamespace("_Ewa");_Ewa.Rd=function(n){this.c=n};_Ewa.Rd.prototype={c:null,a:function(n){return _Ewa.js.a(this.c.d().a(),n.b,n.a,n.c,null,null,null)},b:function(n,t){if(!t)return n;if(!n)return Diag.a.b(39913247,0,!!n,"CheckCollabServiceActionAggregationPerformer.AggregateActionParameters: Received null newActionParameters"),t;if(t.b!==n.b)return Diag.a.a(39913248,0,15,"CheckCollabServiceActionAggregationPerformer.AggregateActionParameters: Found nonidentical OcsSessionIds. newActionParameter.SeqNum: {0}, aggregatedActionParameter.seqNum: {1}",n.a,t.a),n.a<t.a?n:t;var i=n.a>t.a?n.a:t.a;return new _Ewa.yH(n.b,i,n.c)}};_Ewa.Re=function(n){this.c=n};_Ewa.Re.prototype={c:null,a:function(n){return _Ewa.js.c(this.c.d().a(),n.b,n.a,n.c,null,null,null)},b:function(n,t){return t?n?(n.a=!!(n.a&t.a),n):(Diag.a.b(40195267,0,!1,"CheckPersistedActionAggregationPerformer.AggregateActionParameters: Received null newActionParameters"),t):n}};_Ewa.yH=function(n,t,i){this.b=n;this.a=t;this.c=i};_Ewa.yH.prototype={b:null,a:0,c:null};_Ewa.Rg=function(n,t,i,r,u){this.m=Function.createDelegate(this,this.z);this.n=Function.createDelegate(this,this.D);this.q=Function.createDelegate(this,this.B);this.p=Function.createDelegate(this,this.A);this.r=Function.createDelegate(this,this.E);_Ewa.Rg.initializeBase(this,[!1]);this.i=n;this.k=t;this.i.d().d(this.r);this.k.c(this.p);this.k.d(this.q);this.t=i;this.u=r;this.v=u;this.k.a()};_Ewa.Rg.prototype={j:null,i:null,k:null,o:!1,t:null,u:null,v:null,e:function(n){this.dQ("ekcrmrrg",n)},g:function(n){this.dR("ekcrmrrg",n)},a:function(n){this.dQ("ekcrmmcu",n)},c:function(n){this.dR("ekcrmmcu",n)},d:function(n){this.dQ("LabelUpdateEventKey",n)},f:function(n){this.dR("LabelUpdateEventKey",n)},s:null,b:function(){return this.s},y:function(){return!!this.j&&this.j.a()===2},h:function(n,t){if(this.i.c().a())if(Diag.a.a(39150978,0,50,"ContentRefreshManager.UpdatePresenceUsers: clientIdsToAdd=[{0}] clientIdsToRemove=[{1}]",n?n.join(","):"null",t?t.join(","):"null"),this.i.isChangeGateEnabled("OfficeVSO:4540113_UpdatePresenceUsersThrottling"))this.v.a(new _Ewa.Rk(n,t,null));else{var i=this;_Ewa.x.a().a(function(){_Ewa.js.b(i.i.d().a(),n,t,null,null,null,null)},this.i.c().bn(),_Ewa.m.F,!0,!1)}},dispose:function(){this.j&&this.j.i(this.n);this.i&&this.i.d().e(this.r);this.k&&(this.k.e(this.p),this.k.f(this.q));this.j=null;this.i=null;_Ewa.ce.prototype.dispose.call(this)},G:function(n){this.j&&this.j.i(this.n);this.j=$$as(AppRealtimeChannel.d,n);this.j.f(this.n)},D:function(n,t){var u,i,s,a,v,y,p,f,h,c,w,b,k,d,e,g,nt,tt,it,o,r,l,rt,ut,ft,et,ot,st,ht,ct;if(this.o=!0,t.a===1){u=$$as(Array,t.b);(!u||this.F(u))&&this.h(u,null);return}if(i=$$as(Object,t.b),i)if(t.a)if(t.a===3){if(this.i.isChangeGateEnabled("OfficeVSO:4222155_IgnoreKnownUnhandledRtcMessages")){if(!("PresenceType"in i)){Diag.a.a(590751315,13,10,"RTC WetContentUpdate does not specify a type. Ignoring this update.");return}if(f=i.PresenceType,f!==2){f===5||Diag.a.a(590751313,13,10,"RTC WetContentUpdate of unknown type {0}. Ignoring this update.",f);return}}if(!("GeneratedXluid"in i)||!("CollabMode"in i)||!("ClientType"in i)){Diag.a.a(40154954,13,10,"RTC WetContentUpdate is missing some critical fields. Ignoring this update.");return}if(h=i.ClientType,h!==1||"sessionSiteIdentifier"in i&&"CommandTimeInMs"in i||Diag.a.a(40182808,13,10,"RTC WetContentUpdate was sent from ECS and is missing some expected fields. Has SessionSiteIdentifier: {0}, Has UserOperationTimeInMs: {1}.","sessionSiteIdentifier"in i,"CommandTimeInMs"in i),k=(b=this.l(i,w={val:c}),c=w.val,b),k)return;d=new _Ewa.Ri(i.GeneratedXluid,i.CollabMode,h,c,"CommandTimeInMs"in i?i.CommandTimeInMs:0);this.dP("ekcrmrrg",d,this)}else if(t.a===4){if(e=!1,"OnBehalfOfOcs"in i&&(e=i.OnBehalfOfOcs),it=(tt=this.l(i,nt={val:g}),g=nt.val,tt),it)return;if(this.i.c().cx()&&this.x(),this.i.c().T()&&e)return;o=i.Id;!this.i.c().a()||!o||!o.length||this.u.a(new _Ewa.Rh(o,e,this.m))}else t.a===8&&(r=i.SessionId,l=i.SeqNum,!this.i.c().a()||!r||!r.length||(this.i.a(668)?_Ewa.js.a(this.i.d().a(),r,l,this.m,null,null,null):this.t.a(new _Ewa.yH(r,l,this.m))));else y=(v=this.l(i,a={val:s}),s=a.val,v),y?(this.i.a(583)&&this.C(i),"latestStateId"in i&&(p=i.latestStateId,this.i.c().P(p,"ContentRefreshManager.OnUpdateNotificationReceived"),this.w())):Diag.a.a(22905367,0,50,"RTC ContentUpdate session identifier mismatch. Received: {0}. Expected: {1}. Ignoring this update.",s,this.i.c().bi());if(t.a===2&&this.i.a(509)&&this.i.a(387)){if(i){if(et=(ft=this.l(i,ut={val:rt}),rt=ut.val,ft),et)return}else if(!this.i.a(564))return;Diag.a.a(42267869,0,50,"RTC : FileNameUpdate received. Now invoking CheckWorkbookFileNameUpdate web method");_Ewa.js.d(this.i.d().a(),null,null,null,null)}else if(this.i.a(770)&&t.a===12){if(i&&(ct=(ht=this.l(i,st={val:ot}),ot=st.val,ht),ct))return;this.dP("LabelUpdateEventKey",null,null)}},l:function(n,t){t.val="sessionSiteIdentifier"in n?n.sessionSiteIdentifier:null;var i=this.i.c().bi();return i===t.val},z:function(n){var t=n.Errors,i,r;_Ewa.h.e(t)?(t=_Ewa.h.g(t,[1552731907],"ContentRefreshManager"),_Ewa.h.h(t)||this.i.c().s(t)):(i=n.Result,r=n.StateId+1,i&&this.i.c().d()<r&&this.i.c().P(-1,"ContentRefreshManager.OnCheckForUpdateSuccess"))},E:function(){this.y()&&this.o&&this.i.c().br()&&this.w()},w:function(){this.i.c().bN(Math.max(3e4,this.i.c().bn()))},B:function(){this.o=!1;this.i.c().bN(500);this.s=_Ewa.u.a().a()},A:function(n,t){this.G(t.a)},F:function(n){for(var r,u,i=n,f=i.length,t=0;t<f;++t)if(r=i[t],u=this.i.c().bK(r),!u)return!0;return!1},x:function(){this.i.A(1562177611,-1,0,null)},C:function(n){if("MrgCur"in n&&"MrgNxt"in n){var t,i=(t=new _Ewa.oP,t.Pending=n.MrgNxt,t.Current=n.MrgCur,t);this.dP("ekcrmmcu",new _Ewa.yI(i),this)}}};_Ewa.Rh=function(n,t,i){this.b=n;this.a=t;this.c=i};_Ewa.Rh.prototype={b:null,a:!1,c:null};_Ewa.Rj=function(n){this.c=n};_Ewa.Rj.prototype={c:null,a:function(n){if(!this.c.c().a())return $$sc.a.a(Boolean,!0);var t=this,i=this;return _Ewa.f.ts(_Ewa.f.ts($$sc.a.b(0),function(){return _Ewa.js.b(t.c.d().a(),n.e(),n.f(),n.d,null,null,null)},$$sc.f.a,0,$$sc.c.a),function(){return $$sc.a.b(5e3)},$$sc.f.a,0,$$sc.c.a)},b:function(n,t){return t?n?t.g()?t:n.g()?n:(t.h(n),t):(Diag.a.b(578339170,0,!1,"UpdatePresenceUsersActionAggregationPerformer.AggregateActionParameters: Received null newActionParameter"),t):n}};_Ewa.Rk=function(n,t,i){this.b={};this.c={};this.d=i;this.a(n,this.b);this.a(t,this.c)};_Ewa.Rk.prototype={e:function(){return $$sc.j.a(this.b)},f:function(){return $$sc.j.a(this.c)},d:null,g:function(){return!this.e().length&&!this.f().length},h:function(n){this.a(n.e(),this.b);this.a(n.f(),this.c)},a:function(n,t){var u;if(n)for(var r=n,f=r.length,i=0;i<f;++i)u=r[i],t[u]=!0}};_Ewa.Rf=function(n){var i,r,t;this.x=Function.createDelegate(this,this.I);this.r=Function.createDelegate(this,this.G);this.p=Function.createDelegate(this,this.E);this.q=Function.createDelegate(this,this.F);this.s=Function.createDelegate(this,this.H);this.v=Function.createDelegate(this,this.C);this.w=Function.createDelegate(this,this.A);this.y=Function.createDelegate(this,this.N);_Ewa.Rf.initializeBase(this,[!1]);this.a=n;this.i=_Ewa.b.a(this.a).b();this.j=_Ewa.b.a(this.a).i();this.d=this.a.b().a(_Ewa.hs,292,!1,null);this.g=this.a.bB();this.c=new($$sc.u.$$(_Ewa.sx));this.b=new($$sc.r.$$(_Ewa.mK));i=this.a.a(351)?1e3:3e4;this.f=_Ewa.x.a().b(this.y,i,_Ewa.m.E,!1,!1);this.a.D(this.w);this.a.G(this.v);r=this;this.a.b().c(_Ewa.dW,291,function(n){r.h=n},null);this.a.isChangeGateEnabled("OfficeVSO:4388875_ContentLatencyTrackerSubscribesMergeSuspensionManager")&&(t=this,this.a.b().c(_Ewa.jh,343,function(n){t.t||(t.e=n,t.e.a(t.s),t.e.c())},null));this.A(this.a,null)};_Ewa.Rf.prototype={a:null,i:null,j:null,d:null,g:null,h:null,e:null,k:!1,o:null,f:null,t:!1,n:!1,l:!1,m:!1,c:null,b:null,dispose:function(){this.t=!0;this.f&&(this.f.dispose(),this.f=null);this.d&&(this.B(),this.d=null);this.i&&(this.u(),this.i=null);this.j&&(this.u(),this.j=null);this.g&&(this.g=null);this.a&&(this.a=null);this.e&&(this.e.d(this.s),this.e=null);_Ewa.baX.prototype.dispose.call(this)},H:function(n,t){this.k!==t.a&&(this.k=t.a,this.o=this.k?null:_Ewa.u.a().a())},A:function(){this.a.k()&&this.L()},C:function(){(this.c.e.length>0||this.b.f>0)&&(Diag.a.a(40154958,13,15,"Dropping {0} revisionGeneratedNotifications and {1} stateDownloadedNotifications.",this.c.e.length,this.b.f),this.c.g(),this.b=new($$sc.r.$$(_Ewa.mK)));this.f.a();this.B();this.u();this.M()},F:function(n,t){this.J();this.K();var i=new _Ewa.sx;i.Xluid=t.e;i.NotificationReceivedOn=_Ewa.u.a().a().toISOString();i.CurrentPresenceUserCount=this.a.c().x().length;i.OurCollabModeIsUsingOcs=this.a.c().T();i.SenderCollabMode=t.c;i.SenderClientType=t.b;i.SessionSiteIdentifier=t.d;i.CommandTimeInMs=t.a;Diag.a.a(40154959,13,50,"ContentLatencyTracker.OnRemoteRevisionGenerated: RevisionGeneratedNotification: {0}",JSON.stringify(i));this.c.b(i)},L:function(){this.n||(this.d.e(this.q),this.n=!0,this.f.b(-1))},B:function(){this.n&&(this.d.g(this.q),this.n=!1)},J:function(){this.l||(this.i.f(this.p),this.l=!0)},u:function(){this.l&&(this.i.g(this.p),this.l=!1)},K:function(){this.m||(this.j.j(this.r),this.m=!0)},M:function(){this.m&&(this.j.n(this.r),this.m=!1)},E:function(){var n=this.a.c().d();this.z(n,"OnBlockCacheConsistent")},G:function(n,t){var i=$$as(_Ewa.ke,t.a),r;i&&(r=i.o(),this.z(r,"OnRenderedContent"))},z:function(n,t){if(n!==-1&&!this.b.d(n)){var u=_Ewa.u.a().a().toISOString(),i,r=(i=new _Ewa.mK,i.StateId=n,i.DownloadedOn=u,i.IsHidden=this.h?this.h.a():window.document.visibilityState!=="visible",i.DocumentLastUnhidden=this.h&&this.h.h()?this.h.h().toISOString():null,i.LastLostRtcConnection=this.d&&this.d.b()?this.d.b().toISOString():null,i.LastOffline=this.g&&this.g.c()?this.g.c().toISOString():null,i);this.e&&(r.IsPendingMergeBlockedByClient=this.k,this.o&&(r.PendingMergeBlockedByClientLastEnded=this.o.toISOString()));Diag.a.a(41685216,13,50,"ContentLatencyTracker.CreateAndAddstateDownloadedNotifications: {0} - StateDownloadedNotification: {1}",t,JSON.stringify(r));this.b.c(n,r)}},N:function(){var t,n,r,i,u;if(this.c.e.length||this.b.f){if(t=null,this.c.e.length>0&&(t=this.c.f(),this.c.g()),n=null,this.b.f>0){for(n=new Array(this.b.f),r=0,i=this.b.l().$$ge();i.$$mn();)u=i.$$cu(),n[r++]=u;this.b=new($$sc.r.$$(_Ewa.mK))}Diag.a.a(40154963,13,100,"ContentLatencyTracker.UploadLatencyTelemetryPeriodically: Uploading {0} revisionGeneratedNotifications and {1} stateDownloadedNotifications.",t?t.length:0,n?n.length:0);_Ewa.js.e(this.a.d().a(),t,n,this.x,null,null,null)}},I:function(n){if(n.Result){var t=n.Result;t>0&&this.D()}},D:function(){Common.a.e&&(Common.a.e.HasReceivedInboundReplications=!0)}};_Ewa.bgN=function(){};_Ewa.bgN.a=function(){_Ewa.k.a(function(n){_Ewa.f.c(_Ewa.l.a(_Ewa.da,n.b(),12,n.i(),0,null),function(t){var i=t,r=new _Ewa.Rd(n),u=n.b().a(_Ewa.dW,291,!1,null),f=i.a().b(r,r,u),e=new _Ewa.Re(n),o=i.a().b(e,e,u),s=new _Ewa.Rj(n),h=i.a().b(s,s,null);n.b().b(_Ewa.hs,292,new _Ewa.Rg(n,n.b().a(_Ewa.jr,26,!1,null),f,o,h));_Ewa.eP.a(n.b()).a(new _Ewa.Rf(n));_Ewa.eP.a(n.b()).a(f);_Ewa.eP.a(n.b()).a(o)},n.i())})};_Ewa.js=function(){};_Ewa.js.c=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.Id=t,o.OnBehalfOfOcs=i,_Ewa.j.a(n,"CheckPersistedContentUpdate",o,r,u,f,516,null)};_Ewa.js.a=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.OcsSessionId=t,o.SeqNum=i,_Ewa.j.a(n,"CheckCollabServiceContentUpdate",o,r,u,f,516,null)};_Ewa.js.b=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.clientIdsToAdd=t,o.clientIdsToRemove=i,_Ewa.j.a(n,"UpdatePresenceUsers",o,r,u,f,0,null)};_Ewa.js.d=function(n,t,i,r,u){var f=n.a(1,u);return _Ewa.j.a(n,"CheckWorkbookFileNameUpdate",f,t,i,r,0,null)};_Ewa.js.e=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.GenerateNotifications=t,o.DownloadNotifications=i,_Ewa.j.a(n,"UploadLatencyTelemetry",o,r,u,f,128,null)};_Ewa.Rg.registerClass("_Ewa.Rg",_Ewa.ce,_Ewa.hs);_Ewa.Rf.registerClass("_Ewa.Rf",_Ewa.baX);_Ewa.bgN.a();